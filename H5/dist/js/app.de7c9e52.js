(function(e){function t(t){for(var r,s,a=t[0],c=t[1],l=t[2],p=0,m=[];p<a.length;p++)s=a[p],Object.prototype.hasOwnProperty.call(o,s)&&o[s]&&m.push(o[s][0]),o[s]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);u&&u(t);while(m.length)m.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,a=1;a<n.length;a++){var c=n[a];0!==o[c]&&(r=!1)}r&&(i.splice(t--,1),e=s(s.s=n[0]))}return e}var r={},o={app:0},i=[];function s(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=r,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(n,r,function(t){return e[t]}.bind(null,r));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=t,a=a.slice();for(var l=0;l<a.length;l++)t(a[l]);var u=c;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"04d2":function(e,t,n){},"07ca":function(e,t,n){},"0f82":function(e,t,n){"use strict";var r=n("a028"),o=n.n(r);o.a},"1b80":function(e,t,n){"use strict";var r=n("ac04"),o=n.n(r);o.a},2034:function(e,t,n){"use strict";var r=n("35ff"),o=n.n(r);o.a},2650:function(e,t,n){},3491:function(e,t,n){},"35ff":function(e,t,n){},3795:function(e,t,n){"use strict";var r=n("4467"),o=n.n(r);o.a},"3b0b":function(e,t,n){"use strict";var r=n("f2c2"),o=n.n(r);o.a},"3b88":function(e,t,n){},"3f6f":function(e,t,n){},4467:function(e,t,n){},"460e":function(e,t,n){"use strict";var r=n("3491"),o=n.n(r);o.a},4880:function(e,t,n){"use strict";var r=n("d920"),o=n.n(r);o.a},4984:function(e,t,n){},5371:function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("a7cc"),n("450d");var r=n("df33"),o=n.n(r),i=(n("be4f"),n("896a")),s=n.n(i),a=(n("10cb"),n("f3ad")),c=n.n(a),l=(n("f4f9"),n("c2cc")),u=n.n(l),p=(n("7a0f"),n("0f6c")),m=n.n(p),f=(n("1951"),n("eedf")),d=n.n(f),h=(n("9e1f"),n("6ed5")),g=n.n(h),v=(n("0fb7"),n("f529")),b=n.n(v),y=(n("cadf"),n("551c"),n("f751"),n("097d"),n("2b0e")),O=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.src?n("el-image",{staticClass:"avatar",class:e.shape,style:{width:e.width+"px",height:e.height+"px",lineHeight:e.height+"px"},attrs:{src:e.src}},[n("div",{staticClass:"avatar",attrs:{slot:"error"},slot:"error"},[e._v(e._s(e.text[0]))])]):n("div",{staticClass:"avatar",class:e.shape,style:{width:e.width+"px",height:e.height+"px",lineHeight:e.height+"px"}},[e._v(e._s(e.text?e.text[0]:"E"))])],1)},C=[],w=(n("acb6"),n("c673")),_=n.n(w),j=(n("c5f6"),{props:{src:String,text:{type:String,default:"U"},shape:{type:String,default:"circle"},width:{type:Number,default:30},height:{type:Number,default:30}},components:{ElImage:_.a}}),P=j,I=(n("6d4b"),n("2877")),D=Object(I["a"])(P,O,C,!1,null,null,null),x=D.exports,E=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"tim-demo-wrapper"}},[e.isLogin?n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.showLoading,expression:"showLoading"}],staticClass:"demo",attrs:{"element-loading-text":"正在拼命初始化...","element-loading-background":"rgba(0, 0, 0, 0.8)"}},[n("side-bar"),n("current-conversation")],1):n("login")],1)},M=[],k=(n("8e6e"),n("ac6a"),n("456d"),n("4917"),n("6762"),n("2fdb"),n("7f7f"),n("46a1"),n("e5f2")),T=n.n(k),S=n("bd86"),L=n("2f62"),G=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"current-conversation-wrapper"},[e.showCurrentConversation?n("div",{staticClass:"current-conversation",on:{scroll:e.onScroll}},[n("div",{staticClass:"header"},[n("span",{staticClass:"conversation-name text-ellipsis",staticStyle:{"max-width":"60%"}},[e._v(e._s(e.name))]),n("span",{directives:[{name:"show",rawName:"v-show",value:!e.currentConversation.conversationID.includes("SYSTEM"),expression:"!currentConversation.conversationID.includes('SYSTEM')"}],staticClass:"el-icon-more show-more",attrs:{title:"查看详细"},on:{click:e.showMore}})]),n("div",{staticClass:"content",class:e.showMessageSendBox?"":"full-height"},[n("div",{ref:"message-list",staticClass:"message-list",on:{scroll:this.onScroll}},[n("el-button",{staticStyle:{display:"block",margin:"0 auto"},attrs:{type:"text"},on:{click:function(t){return e.$store.dispatch("getMessageList",e.currentConversation.conversationID)}}},[e._v("查看更多")]),e._l(e.currentMessageList,function(e){return n("message-item",{key:e.ID,attrs:{message:e}})})],2),n("a",{directives:[{name:"show",rawName:"v-show",value:e.isShowScrollButtomTips,expression:"isShowScrollButtomTips"}],staticClass:"newMessageTips",on:{click:e.scrollMessageListToButtom}},[e._v("↓回到最新位置↓")])]),e.showMessageSendBox?n("message-send-box"):e._e()],1):e._e(),e.showConversationProfile?n("conversation-profile"):e._e(),n("image-previewer")],1)},R=[],$=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"message-send-box-wrapper"}},[n("div",{staticClass:"send-header-bar"},[n("el-popover",{attrs:{placement:"top",width:"400",trigger:"click"}},[n("div",{staticClass:"emojis"},e._l(e.emojiName,function(t){return n("div",{key:t,staticClass:"emoji",on:{click:function(n){return e.chooseEmoji(t)}}},[n("img",{staticStyle:{width:"25px",height:"25px"},attrs:{src:e.emojiUrl+e.emojiMap[t]}})])}),0),n("i",{staticClass:"iconfont icon-face",attrs:{slot:"reference",title:"发表情"},slot:"reference"})]),n("i",{staticClass:"el-icon-picture-outline",attrs:{title:"发图片"},on:{click:e.handleSendImageClick}}),n("i",{staticClass:"el-icon-folder",attrs:{title:"发文件"},on:{click:e.handleSendFileClick}}),n("i",{staticClass:"iconfont icon-custom",attrs:{title:"发自定义消息"},on:{click:function(t){e.sendCustomDialogVisible=!0}}}),n("i",{staticClass:"iconfont icon-dice",attrs:{title:"投骰子"},on:{click:e.sendDice}})],1),n("el-dialog",{attrs:{title:"发自定消息",visible:e.sendCustomDialogVisible},on:{"update:visible":function(t){e.sendCustomDialogVisible=t}}},[n("el-form",{attrs:{"label-width":"100px"}},[n("el-form-item",{attrs:{label:"data"}},[n("el-input",{model:{value:e.form.data,callback:function(t){e.$set(e.form,"data",t)},expression:"form.data"}})],1),n("el-form-item",{attrs:{label:"description"}},[n("el-input",{model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1),n("el-form-item",{attrs:{label:"extension"}},[n("el-input",{model:{value:e.form.extension,callback:function(t){e.$set(e.form,"extension",t)},expression:"form.extension"}})],1)],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.sendCustomDialogVisible=!1}}},[e._v("取 消")]),n("el-button",{attrs:{type:"primary"},on:{click:e.sendCustomMessage}},[e._v("确 定")])],1)],1),n("el-popover",{staticStyle:{"max-height":"500px","overflow-y":"scroll"},attrs:{trigger:"manual",placement:"top"},model:{value:e.showAtGroupMember,callback:function(t){e.showAtGroupMember=t},expression:"showAtGroupMember"}},[e._l(e.memberList,function(t){return n("el-radio-group",{key:t.userID,staticStyle:{display:"flex","flex-decoration":"column"},on:{change:e.handleSelectAtUser},model:{value:e.atUserID,callback:function(t){e.atUserID=t},expression:"atUserID"}},[n("el-radio",{attrs:{label:t.userID}},[e._v(e._s(t.nameCard||t.nick||t.userID))])],1)}),n("el-input",{staticClass:"text-input",attrs:{slot:"reference",type:"textarea",rows:4,resize:"none"},on:{input:e.handleTextInput},nativeOn:{keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.handleEnter(t))},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"up",38,t.key,["Up","ArrowUp"])?null:(t.preventDefault(),e.handleUp(t))},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"])?null:(t.preventDefault(),e.handleDown(t))}]},slot:"reference",model:{value:e.messageContent,callback:function(t){e.messageContent=t},expression:"messageContent"}})],2),n("input",{ref:"imagePicker",staticStyle:{display:"none"},attrs:{type:"file",id:"imagePicker",accept:".jpg, .jpeg, .png, .gif"},on:{change:e.sendImage}}),n("input",{ref:"filePicker",staticStyle:{display:"none"},attrs:{type:"file",id:"filePicker"},on:{change:e.sendFile}}),n("el-button",{staticClass:"btn-send",attrs:{size:"small"},on:{click:e.sendTextMessage}},[e._v("发送(Enter)")])],1)},N=[],U=(n("20d6"),n("b5d8"),n("f494")),A=n.n(U),B=(n("fe07"),n("6ac5")),F=n.n(B),V=(n("06f1"),n("6ac9")),Y=n.n(V),q=(n("eca7"),n("3787")),z=n.n(q),K=(n("425f"),n("4105")),J=n.n(K),H="https://imgcache.qq.com/open/qcloud/tim/assets/emoji/",W={"[NO]":"emoji_0@2x.png","[OK]":"emoji_1@2x.png","[下雨]":"emoji_2@2x.png","[么么哒]":"emoji_3@2x.png","[乒乓]":"emoji_4@2x.png","[便便]":"emoji_5@2x.png","[信封]":"emoji_6@2x.png","[偷笑]":"emoji_7@2x.png","[傲慢]":"emoji_8@2x.png","[再见]":"emoji_9@2x.png","[冷汗]":"emoji_10@2x.png","[凋谢]":"emoji_11@2x.png","[刀]":"emoji_12@2x.png","[删除]":"emoji_13@2x.png","[勾引]":"emoji_14@2x.png","[发呆]":"emoji_15@2x.png","[发抖]":"emoji_16@2x.png","[可怜]":"emoji_17@2x.png","[可爱]":"emoji_18@2x.png","[右哼哼]":"emoji_19@2x.png","[右太极]":"emoji_20@2x.png","[右车头]":"emoji_21@2x.png","[吐]":"emoji_22@2x.png","[吓]":"emoji_23@2x.png","[咒骂]":"emoji_24@2x.png","[咖啡]":"emoji_25@2x.png","[啤酒]":"emoji_26@2x.png","[嘘]":"emoji_27@2x.png","[回头]":"emoji_28@2x.png","[困]":"emoji_29@2x.png","[坏笑]":"emoji_30@2x.png","[多云]":"emoji_31@2x.png","[大兵]":"emoji_32@2x.png","[大哭]":"emoji_33@2x.png","[太阳]":"emoji_34@2x.png","[奋斗]":"emoji_35@2x.png","[奶瓶]":"emoji_36@2x.png","[委屈]":"emoji_37@2x.png","[害羞]":"emoji_38@2x.png","[尴尬]":"emoji_39@2x.png","[左哼哼]":"emoji_40@2x.png","[左太极]":"emoji_41@2x.png","[左车头]":"emoji_42@2x.png","[差劲]":"emoji_43@2x.png","[弱]":"emoji_44@2x.png","[强]":"emoji_45@2x.png","[彩带]":"emoji_46@2x.png","[彩球]":"emoji_47@2x.png","[得意]":"emoji_48@2x.png","[微笑]":"emoji_49@2x.png","[心碎了]":"emoji_50@2x.png","[快哭了]":"emoji_51@2x.png","[怄火]":"emoji_52@2x.png","[怒]":"emoji_53@2x.png","[惊恐]":"emoji_54@2x.png","[惊讶]":"emoji_55@2x.png","[憨笑]":"emoji_56@2x.png","[手枪]":"emoji_57@2x.png","[打哈欠]":"emoji_58@2x.png","[抓狂]":"emoji_59@2x.png","[折磨]":"emoji_60@2x.png","[抠鼻]":"emoji_61@2x.png","[抱抱]":"emoji_62@2x.png","[抱拳]":"emoji_63@2x.png","[拳头]":"emoji_64@2x.png","[挥手]":"emoji_65@2x.png","[握手]":"emoji_66@2x.png","[撇嘴]":"emoji_67@2x.png","[擦汗]":"emoji_68@2x.png","[敲打]":"emoji_69@2x.png","[晕]":"emoji_70@2x.png","[月亮]":"emoji_71@2x.png","[棒棒糖]":"emoji_72@2x.png","[汽车]":"emoji_73@2x.png","[沙发]":"emoji_74@2x.png","[流汗]":"emoji_75@2x.png","[流泪]":"emoji_76@2x.png","[激动]":"emoji_77@2x.png","[灯泡]":"emoji_78@2x.png","[炸弹]":"emoji_79@2x.png","[熊猫]":"emoji_80@2x.png","[爆筋]":"emoji_81@2x.png","[爱你]":"emoji_82@2x.png","[爱心]":"emoji_83@2x.png","[爱情]":"emoji_84@2x.png","[猪头]":"emoji_85@2x.png","[猫咪]":"emoji_86@2x.png","[献吻]":"emoji_87@2x.png","[玫瑰]":"emoji_88@2x.png","[瓢虫]":"emoji_89@2x.png","[疑问]":"emoji_90@2x.png","[白眼]":"emoji_91@2x.png","[皮球]":"emoji_92@2x.png","[睡觉]":"emoji_93@2x.png","[磕头]":"emoji_94@2x.png","[示爱]":"emoji_95@2x.png","[礼品袋]":"emoji_96@2x.png","[礼物]":"emoji_97@2x.png","[篮球]":"emoji_98@2x.png","[米饭]":"emoji_99@2x.png","[糗大了]":"emoji_100@2x.png","[红双喜]":"emoji_101@2x.png","[红灯笼]":"emoji_102@2x.png","[纸巾]":"emoji_103@2x.png","[胜利]":"emoji_104@2x.png","[色]":"emoji_105@2x.png","[药]":"emoji_106@2x.png","[菜刀]":"emoji_107@2x.png","[蛋糕]":"emoji_108@2x.png","[蜡烛]":"emoji_109@2x.png","[街舞]":"emoji_110@2x.png","[衰]":"emoji_111@2x.png","[西瓜]":"emoji_112@2x.png","[调皮]":"emoji_113@2x.png","[象棋]":"emoji_114@2x.png","[跳绳]":"emoji_115@2x.png","[跳跳]":"emoji_116@2x.png","[车厢]":"emoji_117@2x.png","[转圈]":"emoji_118@2x.png","[鄙视]":"emoji_119@2x.png","[酷]":"emoji_120@2x.png","[钞票]":"emoji_121@2x.png","[钻戒]":"emoji_122@2x.png","[闪电]":"emoji_123@2x.png","[闭嘴]":"emoji_124@2x.png","[闹钟]":"emoji_125@2x.png","[阴险]":"emoji_126@2x.png","[难过]":"emoji_127@2x.png","[雨伞]":"emoji_128@2x.png","[青蛙]":"emoji_129@2x.png","[面条]":"emoji_130@2x.png","[鞭炮]":"emoji_131@2x.png","[风车]":"emoji_132@2x.png","[飞吻]":"emoji_133@2x.png","[飞机]":"emoji_134@2x.png","[饥饿]":"emoji_135@2x.png","[香蕉]":"emoji_136@2x.png","[骷髅]":"emoji_137@2x.png","[麦克风]":"emoji_138@2x.png","[麻将]":"emoji_139@2x.png","[鼓掌]":"emoji_140@2x.png","[龇牙]":"emoji_141@2x.png"},Z=["[龇牙]","[调皮]","[流汗]","[偷笑]","[再见]","[敲打]","[擦汗]","[猪头]","[玫瑰]","[流泪]","[大哭]","[嘘]","[酷]","[抓狂]","[委屈]","[便便]","[炸弹]","[菜刀]","[可爱]","[色]","[害羞]","[得意]","[吐]","[微笑]","[怒]","[尴尬]","[惊恐]","[冷汗]","[爱心]","[示爱]","[白眼]","[傲慢]","[难过]","[惊讶]","[疑问]","[困]","[么么哒]","[憨笑]","[爱情]","[衰]","[撇嘴]","[阴险]","[奋斗]","[发呆]","[右哼哼]","[抱抱]","[坏笑]","[飞吻]","[鄙视]","[晕]","[大兵]","[可怜]","[强]","[弱]","[握手]","[胜利]","[抱拳]","[凋谢]","[米饭]","[蛋糕]","[西瓜]","[啤酒]","[瓢虫]","[勾引]","[OK]","[爱你]","[咖啡]","[月亮]","[刀]","[发抖]","[差劲]","[拳头]","[心碎了]","[太阳]","[礼物]","[皮球]","[骷髅]","[挥手]","[闪电]","[饥饿]","[咒骂]","[折磨]","[抠鼻]","[鼓掌]","[糗大了]","[左哼哼]","[打哈欠]","[快哭了]","[吓]","[篮球]","[乒乓]","[NO]","[跳跳]","[怄火]","[转圈]","[磕头]","[回头]","[跳绳]","[激动]","[街舞]","[献吻]","[左太极]","[右太极]","[闭嘴]","[猫咪]","[红双喜]","[鞭炮]","[红灯笼]","[麻将]","[麦克风]","[礼品袋]","[信封]","[象棋]","[彩带]","[蜡烛]","[爆筋]","[棒棒糖]","[奶瓶]","[面条]","[香蕉]","[飞机]","[左车头]","[车厢]","[右车头]","[多云]","[下雨]","[钞票]","[熊猫]","[灯泡]","[风车]","[闹钟]","[雨伞]","[彩球]","[钻戒]","[沙发]","[纸巾]","[手枪]","[青蛙]"];function X(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?X(n,!0).forEach(function(t){Object(S["a"])(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):X(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var ee={name:"message-send-box",props:["scrollMessageListToButtom"],components:{ElInput:c.a,ElForm:J.a,ElFormItem:z.a,ElDialog:o.a,ElPopover:Y.a,ElRadioGroup:F.a,ElRadio:A.a},data:function(){return{messageContent:"",isSendCustomMessage:!1,sendCustomDialogVisible:!1,form:{data:"",description:"",extension:""},file:"",emojiMap:W,emojiName:Z,emojiUrl:H,showAtGroupMember:!1,atUserID:""}},computed:Q({},Object(L["b"])(["toAccount","currentConversationType"]),{},Object(L["c"])({memberList:function(e){return e.group.currentMemberList}})),methods:{handleTextInput:function(e){"@"===e.slice(-1)&&this.currentConversationType===this.TIM.TYPES.CONV_GROUP&&this.memberList.length>0?(this.atUserID=this.memberList[0].userID,this.showAtGroupMember=!0):this.showAtGroupMember=!1},handleSelectAtUser:function(){this.messageContent+=this.atUserID+" ",this.showAtGroupMember=!1},handleUp:function(){var e=this,t=this.memberList.findIndex(function(t){return t.userID===e.atUserID});t-1<0||(this.atUserID=this.memberList[t-1].userID)},handleDown:function(){var e=this,t=this.memberList.findIndex(function(t){return t.userID===e.atUserID});t+1>=this.memberList.length||(this.atUserID=this.memberList[t+1].userID)},handleEnter:function(){this.showAtGroupMember?this.handleSelectAtUser():this.sendTextMessage()},sendTextMessage:function(){if(""===this.messageContent||0===this.messageContent.trim().length)return this.messageContent="",void this.$message("不能发送空消息哦！");var e=this.tim.createTextMessage({to:this.toAccount,conversationType:this.currentConversationType,payload:{text:this.messageContent}});this.$store.commit("pushCurrentMessageList",e),this.$bus.$emit("scroll-bottom"),this.tim.sendMessage(e),this.messageContent=""},sendCustomMessage:function(){if(0!==this.form.data.length||0!==this.form.description.length||0!==this.form.extension.length){var e=this.tim.createCustomMessage({to:this.toAccount,conversationType:this.currentConversationType,payload:{data:this.form.data,description:this.form.description,extension:this.form.extension}});this.$store.commit("pushCurrentMessageList",e),this.tim.sendMessage(e),Object.assign(this.form,{data:"",description:"",extension:""}),this.sendCustomDialogVisible=!1}else this.$message.warning("不能发送空消息")},random:function(e,t){return Math.floor(Math.random()*(t-e+1)+e)},sendDice:function(){var e=this.tim.createCustomMessage({to:this.toAccount,conversationType:this.currentConversationType,payload:{data:"dice",description:String(this.random(1,6)),extension:""}});this.$store.commit("pushCurrentMessageList",e),this.tim.sendMessage(e)},chooseEmoji:function(e){this.messageContent+=e},handleSendImageClick:function(){this.$refs.imagePicker.click()},handleSendFileClick:function(){this.$refs.filePicker.click()},sendImage:function(){var e=this,t=this.tim.createImageMessage({to:this.toAccount,conversationType:this.currentConversationType,payload:{file:document.getElementById("imagePicker")},onProgress:function(n){e.$set(t,"progress",n)}});this.$store.commit("pushCurrentMessageList",t),this.tim.sendMessage(t).catch(function(t){return e.$message.error(t.message)}),this.$refs.imagePicker.value=null},sendFile:function(){var e=this,t=this.tim.createFileMessage({to:this.toAccount,conversationType:this.currentConversationType,payload:{file:document.getElementById("filePicker")},onProgress:function(n){e.$set(t,"progress",n)}});this.$store.commit("pushCurrentMessageList",t),this.tim.sendMessage(t).catch(function(t){return e.$message.error(t.message)}),this.$refs.filePicker.value=null}}},te=ee,ne=(n("3b0b"),Object(I["a"])(te,$,N,!1,null,null,null)),re=ne.exports,oe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"message-wrapper",class:e.messagePosition},[e.showMessageHeader?n("message-header",{attrs:{message:e.message}}):e._e(),n("div",{staticClass:"content"},[n("message-status-icon",{attrs:{message:e.message}}),e.message.type===e.TIM.TYPES.MSG_TEXT?n("text-element",{attrs:{isMine:e.isMine,payload:e.message.payload}}):e.message.type===e.TIM.TYPES.MSG_IMAGE?n("image-element",{attrs:{payload:e.message.payload}}):e.message.type===e.TIM.TYPES.MSG_FILE?n("file-element",{attrs:{payload:e.message.payload}}):e.message.type===e.TIM.TYPES.MSG_SOUND?n("sound-element",{attrs:{payload:e.message.payload}}):e.message.type===e.TIM.TYPES.MSG_GRP_TIP?n("group-tip-element",{attrs:{payload:e.message.payload}}):e.message.type===e.TIM.TYPES.MSG_GRP_SYS_NOTICE?n("group-system-notice-element",{attrs:{payload:e.message.payload,message:e.message}}):e.message.type===e.TIM.TYPES.MSG_CUSTOM?n("custom-element",{attrs:{payload:e.message.payload}}):e.message.type===e.TIM.TYPES.MSG_FACE?n("face-element",{attrs:{payload:e.message.payload}}):n("span",[e._v("暂未支持的消息类型："+e._s(e.message.type))])],1)],1)},ie=[],se=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",{class:e.messageIconClass,staticStyle:{width:"16px",height:"16px"},on:{click:e.handleIconClick}},[e._v(e._s("message-send-fail"===e.messageIconClass?"!":""))])},ae=[],ce={name:"MessageStatusIcon",props:{message:{type:Object,required:!0}},computed:{messageIconClass:function(){switch(this.message.status){case"unSend":return"el-icon-loading";case"fail":return"message-send-fail";default:return""}}},methods:{handleIconClick:function(){var e=this;"message-send-fail"===this.messageIconClass&&this.tim.resendMessage(this.message).catch(function(t){e.$message.error(t.message)})}}},le=ce,ue=(n("1b80"),Object(I["a"])(le,se,ae,!1,null,null,null)),pe=ue.exports,me=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"from",style:{textAlign:e.isMine?"right":"left",color:"gray",fontSize:"14px"}},[n("span",{staticClass:"name text-ellipsis"},[e._v(e._s(e.from))]),n("span",{staticStyle:{"margin-left":"12px"}},[e._v(e._s(e.date))])])},fe=[];function de(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-",n=e.getFullYear(),r=e.getMonth()+1,o=e.getDate();return"".concat(n).concat(t).concat(be(r)).concat(t).concat(be(o))}function he(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.getHours(),r=e.getMinutes(),o=e.getSeconds();return t?"".concat(be(n),":").concat(be(r),":").concat(be(o)):"".concat(n,":").concat(be(r))}function ge(e){return"".concat(de(e)," ").concat(he(e))}function ve(e){return e.toDateString()===(new Date).toDateString()}function be(e){return e<10?"0".concat(e):e}function ye(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Oe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ye(n,!0).forEach(function(t){Object(S["a"])(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ye(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Ce={name:"MessageHeader",props:{message:{type:Object,required:!0}},computed:Oe({},Object(L["c"])({currentConversation:function(e){return e.conversation.currentConversation},currentUserProfile:function(e){return e.user.currentUserProfile},currentMemberList:function(e){return e.group.currentMemberList}}),{date:function(){return ge(new Date(1e3*this.message.time))},from:function(){var e=this.currentConversation.type===this.TIM.TYPES.CONV_C2C;return this.isMine?this.currentUserProfile.nick||this.currentUserProfile.userID:e?this.currentConversation.userProfile.nick||this.currentConversation.userProfile.userID:this.message.nick||this.message.from},isMine:function(){return"out"===this.message.flow}})},we=Ce,_e=(n("0f82"),Object(I["a"])(we,me,fe,!1,null,"83379fa0",null)),je=_e.exports,Pe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"file-element-wrapper"},[n("div",{staticClass:"header"},[n("i",{staticClass:"el-icon-document file-icon"}),n("div",{staticClass:"file-element"},[n("span",{staticClass:"file-name"},[e._v(e._s(e.fileName))]),n("span",{staticClass:"file-size"},[e._v(e._s(e.size))])])]),n("div",{staticClass:"footer"},[n("span",{staticClass:"download-link",on:{click:e.downloadFile}},[e._v("下载")])]),e.showProgressBar?n("el-progress",{attrs:{percentage:e.percentage,color:function(e){return 100===e?"#67c23a":"#409eff"}}}):e._e()],1)},Ie=[],De=(n("6b30"),n("c284")),xe=n.n(De),Ee={name:"FileElement",props:{payload:{type:Object,required:!0}},components:{ElProgress:xe.a},computed:{fileName:function(){return this.payload.fileName},fileUrl:function(){return this.payload.fileUrl},size:function(){var e=this.payload.fileSize;return e>1024?e/1024>1024?"".concat(this.toFixed(e/1024/1024)," Mb"):"".concat(this.toFixed(e/1024)," Kb"):"".concat(this.toFixed(e),"B")},showProgressBar:function(){return"unSend"===this.$parent.message.status},percentage:function(){return Math.floor(100*(this.$parent.message.progress||0))}},methods:{toFixed:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return e.toFixed(t)},downloadFile:function(){var e=this;if(window.fetch)fetch(this.fileUrl).then(function(e){return e.blob()}).then(function(t){var n=document.createElement("a"),r=window.URL.createObjectURL(t);n.href=r,n.download=e.fileName,n.click()});else{var t=document.createElement("a");t.href=this.fileUrl,t.target="_blank",t.download=this.filename,t.click()}}}},Me=Ee,ke=(n("3795"),Object(I["a"])(Me,Pe,Ie,!1,null,"f950b860",null)),Te=ke.exports,Se=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"face-element-wrapper"},[n("img",{staticStyle:{height:"90px",width:"90px"},attrs:{src:e.url}})])},Le=[],Ge={name:"FaceElement",props:{payload:{type:Object,required:!0}},computed:{url:function(){return"https://imgcache.qq.com/open/qcloud/tim/assets/face-elem/".concat(this.payload.data,".png")}}},Re=Ge,$e=Object(I["a"])(Re,Se,Le,!1,null,null,null),Ne=$e.exports,Ue=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("img",{staticClass:"image-element",attrs:{src:e.imageUrl},on:{load:e.onImageLoaded,click:e.handlePreview}}),e.showProgressBar?n("el-progress",{attrs:{percentage:e.percentage,color:function(e){return 100===e?"#67c23a":"#409eff"}}}):e._e()],1)},Ae=[];function Be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Fe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Be(n,!0).forEach(function(t){Object(S["a"])(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Be(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Ve={name:"ImageElemnt",props:{payload:{type:Object,required:!0}},components:{ElProgress:xe.a},computed:Fe({},Object(L["b"])(["imgUrlList"]),{imageUrl:function(){var e=this.payload.imageInfoArray[0].url;return"string"!==typeof e?"":"//"===e.slice(0,2)?"https:".concat(e):e},showProgressBar:function(){return"unSend"===this.$parent.message.status},percentage:function(){return Math.floor(100*(this.$parent.message.progress||0))}}),methods:{onImageLoaded:function(e){this.$bus.$emit("image-loaded",e)},handlePreview:function(){this.$bus.$emit("image-preview",{url:this.payload.imageInfoArray[0].url})}}},Ye=Ve,qe=(n("2034"),Object(I["a"])(Ye,Ue,Ae,!1,null,"9887e83a",null)),ze=qe.exports,Ke=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"text-element-wrapper",class:e.isMine?"element-send":"element-received"},[n("div",{staticClass:"text-element"},[e._l(e.contentList,function(t,r){return["text"===t.name?n("span",{key:r},[e._v(e._s(t.text))]):"img"===t.name?n("img",{key:r,attrs:{src:t.src,width:"20px",height:"20px"}}):e._e()]})],2)])},Je=[];function He(e){var t=[],n=e.text,r=-1,o=-1;while(""!==n)switch(r=n.indexOf("["),o=n.indexOf("]"),r){case 0:if(-1===o)t.push({name:"text",text:n}),n="";else{var i=n.slice(0,o+1);W[i]?(t.push({name:"img",src:H+W[i]}),n=n.substring(o+1)):(t.push({name:"text",text:"["}),n=n.slice(1))}break;case-1:t.push({name:"text",text:n}),n="";break;default:t.push({name:"text",text:n.slice(0,r)}),n=n.substring(r);break}return t}var We={name:"TextElement",props:{payload:{type:Object,required:!0},isMine:{type:Boolean}},computed:{contentList:function(){return He(this.payload)}}},Ze=We,Xe=(n("c6a9"),Object(I["a"])(Ze,Ke,Je,!1,null,"679f4636",null)),Qe=Xe.exports,et=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"sound-element-wrapper",on:{click:e.play}},[n("i",{staticClass:"iconfont icon-voice"}),e._v("\n  "+e._s(e.second+'"')+"\n")])},tt=[],nt={name:"SoundElement",props:{payload:{type:Object,required:!0}},data:function(){return{amr:null}},computed:{url:function(){return this.payload.url},size:function(){return this.payload.size},second:function(){return this.payload.second}},methods:{play:function(){var e=document.createElement("audio");e.addEventListener("error",this.tryPlayAMR),e.src=this.url;var t=e.play();t&&t.catch(function(){})},tryPlayAMR:function(){try{var e=/MSIE|Trident|Edge/.test(window.navigator.userAgent);if(e)return void this.$message.warning("您的浏览器不支持该格式的语音消息播放，请尝试更换浏览器，建议使用：谷歌浏览器");if(!window.BenzAMRRecorder){var t=document.createElement("script");t.addEventListener("load",this.playAMR),t.src="./BenzAMRRecorder.js";var n=document.getElementsByTagName("script")[0];return void n.parentNode.insertBefore(t,n)}this.playAMR()}catch(r){this.$message.warning("您的浏览器不支持该格式的语音消息播放，请尝试更换浏览器，建议使用：谷歌浏览器")}},playAMR:function(){var e=this;!this.amr&&window.BenzAMRRecorder&&(this.amr=new window.BenzAMRRecorder),this.amr.isInit()?this.amr.play():this.amr.initWithUrl(this.url).then(function(){e.amr.play()})}}},rt=nt,ot=(n("95c5"),Object(I["a"])(rt,et,tt,!1,null,null,null)),it=ot.exports,st=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"group-tip-element-wrapper"},[e._v(e._s(e.text))])},at=[],ct={name:"GroupTipElement",props:{payload:{type:Object,required:!0}},computed:{text:function(){return this.getGroupTipContent(this.payload)}},methods:{getGroupTipContent:function(e){switch(e.operationType){case this.TIM.TYPES.GRP_TIP_MBR_JOIN:return"群成员：".concat(e.userIDList.join(","),"，加入群组");case this.TIM.TYPES.GRP_TIP_MBR_QUIT:return"群成员：".concat(e.userIDList.join(","),"，退出群组");case this.TIM.TYPES.GRP_TIP_MBR_KICKED_OUT:return"群成员：".concat(e.userIDList.join(","),"，被").concat(e.operatorID,"踢出群组");case this.TIM.TYPES.GRP_TIP_MBR_SET_ADMIN:return"群成员：".concat(e.userIDList.join(","),"，成为管理员");case this.TIM.TYPES.GRP_TIP_MBR_CANCELED_ADMIN:return"群成员：".concat(e.userIDList.join(","),"，被撤销管理员");default:return"[群提示消息]"}}}},lt=ct,ut=(n("f822"),Object(I["a"])(lt,st,at,!1,null,"da979c3e",null)),pt=ut.exports,mt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"group-system-element-wrapper"},[e._v("\n  "+e._s(e.text)+"\n  "),e.isJoinGroupRequest?n("el-button",{attrs:{type:"text"},on:{click:function(t){e.showDialog=!0}}},[e._v("处理")]):e._e(),n("el-dialog",{attrs:{title:"处理加群申请",visible:e.showDialog},on:{"update:visible":function(t){e.showDialog=t}}},[n("el-form",{ref:"form",attrs:{"label-width":"100px"},model:{value:e.form,callback:function(t){e.form=t},expression:"form"}},[n("el-form-item",{attrs:{label:"处理结果："}},[n("el-radio-group",{model:{value:e.form.handleAction,callback:function(t){e.$set(e.form,"handleAction",t)},expression:"form.handleAction"}},[n("el-radio",{attrs:{label:"Agree"}},[e._v("同意")]),n("el-radio",{attrs:{label:"Reject"}},[e._v("拒绝")])],1)],1),n("el-form-item",{attrs:{label:"附言："}},[n("el-input",{attrs:{type:"textarea",resize:"none",rows:3,placeholder:"请输入附言"},model:{value:e.form.handleMessage,callback:function(t){e.$set(e.form,"handleMessage",t)},expression:"form.handleMessage"}})],1)],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.showDialog=!1}}},[e._v("取 消")]),n("el-button",{attrs:{type:"primary"},on:{click:e.handleGroupApplication}},[e._v("确 定")])],1)],1)],1)},ft=[],dt={name:"GroupSystemNoticeElement",props:{payload:{type:Object,required:!0},message:{type:Object,required:!1}},components:{ElDialog:o.a,ElForm:J.a,ElFormItem:z.a,ElRadioGroup:F.a,ElRadio:A.a},data:function(){return{showDialog:!1,form:{handleAction:"Agree",handleMessage:""}}},computed:{text:function(){return this.translateGroupSystemNotice(this.payload)},isJoinGroupRequest:function(){return 1===this.payload.operationType}},methods:{translateGroupSystemNotice:function(e){var t=e.groupProfile.groupName||e.groupProfile.groupID;switch(e.operationType){case 1:return"".concat(e.operatorID," 申请加入群组：").concat(t);case 2:return"成功加入群组：".concat(t);case 3:return"申请加入群组：".concat(t,"被拒绝");case 4:return"被管理员".concat(e.operatorID,"踢出群组：").concat(t);case 5:return"群：".concat(t," 已被").concat(e.operatorID,"解散");case 6:return"".concat(e.operatorID,"创建群：").concat(t);case 7:return"".concat(e.operatorID,"邀请你加群：").concat(t);case 8:return"你退出群组：".concat(t);case 9:return"你被".concat(e.operatorID,"设置为群：").concat(t,"的管理员");case 10:return"你被".concat(e.operatorID,"撤销群：").concat(t,"的管理员身份");case 255:return"自定义群系统通知"}},handleGroupApplication:function(){var e=this;this.tim.handleGroupApplication({handleAction:this.form.handleAction,handleMessage:this.form.handleMessage,message:this.message}).then(function(){e.showDialog=!1}).catch(function(){e.showDialog=!1})}}},ht=dt,gt=Object(I["a"])(ht,mt,ft,!1,null,null,null),vt=gt.exports,bt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"custom-element-wrapper"},[e.isDice?n("span",{staticClass:"iconfont dice",class:"icon-dice"+e.payload.description}):n("span",[e._v(e._s(e.text))])])},yt=[],Ot={name:"CustomElement",props:{payload:{type:Object,required:!0}},computed:{text:function(){return this.translateCustomMessage(this.payload)},isDice:function(){return"dice"===this.payload.data}},methods:{translateCustomMessage:function(e){return"group_create"===e.data?"".concat(e.extension):"[自定义消息]"}}},Ct=Ot,wt=(n("4880"),Object(I["a"])(Ct,bt,yt,!1,null,"6594ac8d",null)),_t=wt.exports;function jt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Pt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jt(n,!0).forEach(function(t){Object(S["a"])(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jt(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var It={name:"MessageItem",props:{message:{type:Object,required:!0}},components:{MessageHeader:je,MessageStatusIcon:pe,FileElement:Te,FaceElement:Ne,ImageElement:ze,TextElement:Qe,SoundElement:it,GroupTipElement:pt,GroupSystemNoticeElement:vt,CustomElement:_t},data:function(){return{renderDom:[]}},computed:Pt({},Object(L["c"])({currentConversation:function(e){return e.conversation.currentConversation},currentUserProfile:function(e){return e.user.currentUserProfile}}),{isMine:function(){return"out"===this.message.flow},messagePosition:function(){return["TIMGroupTipElem","TIMGroupSystemNoticeElem"].includes(this.message.elements[0].type)?"position-center":this.isMine?"position-right":"position-left"},showMessageHeader:function(){return!["TIMGroupTipElem","TIMGroupSystemNoticeElem"].includes(this.message.elements[0].type)}})},Dt=It,xt=(n("8c43"),Object(I["a"])(Dt,oe,ie,!1,null,"1a1e7fad",null)),Et=xt.exports,Mt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"conversation-profile-wrapper"},[e.currentConversation.type===e.TIM.TYPES.CONV_C2C?n("user-profile",{attrs:{userProfile:e.currentConversation.userProfile}}):e.currentConversation.type===e.TIM.TYPES.CONV_GROUP?n("group-profile",{attrs:{groupProfile:e.currentConversation.groupProfile}}):e._e()],1)},kt=[],Tt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("group-member-list",{attrs:{groupProfile:e.groupProfile}}),n("div",{staticClass:"info-item"},[n("div",{staticClass:"label"},[e._v("群ID")]),n("div",{staticClass:"content"},[e._v(e._s(e.groupProfile.groupID))])]),n("div",{staticClass:"info-item"},[n("div",{staticClass:"label"},[e._v("\n      群头像\n      "),e.editable?n("i",{staticClass:"el-icon-edit",on:{click:function(t){e.showEditFaceUrl=!0,e.inputFocus("editFaceUrl")}}}):e._e()]),e.showEditFaceUrl?n("el-input",{ref:"editFaceUrl",attrs:{autofocus:"",size:"mini"},on:{blur:function(t){e.showEditFaceUrl=!1}},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.editFaceUrl(t)}},model:{value:e.avatar,callback:function(t){e.avatar=t},expression:"avatar"}}):n("div",{staticClass:"content",staticStyle:{display:"flex","align-items":"center"}},[n("avatar",{staticStyle:{"margin-right":"6px"},attrs:{src:e.groupProfile.avatar,text:"G"}})],1)],1),n("div",{staticClass:"info-item"},[n("div",{staticClass:"label"},[e._v("群类型")]),n("div",{staticClass:"content"},[e._v(e._s(e.groupProfile.type))])]),n("div",{staticClass:"info-item"},[n("div",{staticClass:"label"},[e._v("\n      群名称\n      "),e.editable?n("i",{staticClass:"el-icon-edit",on:{click:function(t){e.showEditName=!0,e.inputFocus("editName")}}}):e._e()]),e.showEditName?n("el-input",{ref:"editName",attrs:{autofocus:"",size:"mini"},on:{blur:function(t){e.showEditName=!1}},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.editName(t)}},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}):n("div",{staticClass:"content text-ellipsis"},[e._v(e._s(e.groupProfile.name||"暂无"))])],1),n("div",{staticClass:"info-item"},[n("div",{staticClass:"label"},[e._v("\n      群介绍\n      "),e.editable?n("i",{staticClass:"el-icon-edit",on:{click:function(t){e.showEditIntroduction=!0,e.inputFocus("editIntroduction")}}}):e._e()]),e.showEditIntroduction?n("el-input",{ref:"editIntroduction",attrs:{autofocus:"",size:"mini"},on:{blur:function(t){e.showEditIntroduction=!1}},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.editIntroduction(t)}},model:{value:e.introduction,callback:function(t){e.introduction=t},expression:"introduction"}}):n("div",{staticClass:"content text-ellipsis"},[e._v(e._s(e.groupProfile.introduction||"暂无"))])],1),n("div",{staticClass:"info-item"},[n("div",{staticClass:"label"},[e._v("\n      群公告\n      "),e.editable?n("i",{staticClass:"el-icon-edit",on:{click:function(t){e.showEditNotification=!0,e.inputFocus("editNotification")}}}):e._e()]),e.showEditNotification?n("el-input",{ref:"editNotification",attrs:{autofocus:"",size:"mini"},on:{blur:function(t){e.showEditNotification=!1}},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.editNotification(t)}},model:{value:e.notification,callback:function(t){e.notification=t},expression:"notification"}}):n("div",{staticClass:"content text-ellipsis"},[e._v(e._s(e.groupProfile.notification||"暂无"))])],1),"Private"!==e.groupProfile.type?n("div",{staticClass:"info-item"},[n("div",{staticClass:"label"},[e._v("\n      申请加群方式\n      "),e.joinOptionEditable?n("i",{staticClass:"el-icon-edit",on:{click:function(t){e.showEditJoinOption=!0,e.inputFocus("editJoinOption")}}}):e._e()]),n("div",{directives:[{name:"show",rawName:"v-show",value:!e.showEditJoinOption,expression:"!showEditJoinOption"}],staticClass:"content"},[e._v(e._s(e.joinOptionMap[e.groupProfile.joinOption]))]),n("el-select",{directives:[{name:"show",rawName:"v-show",value:e.showEditJoinOption,expression:"showEditJoinOption"}],ref:"editJoinOption",attrs:{size:"mini","automatic-dropdown":""},on:{blur:function(t){e.showEditJoinOption=!1},change:e.editJoinOption},model:{value:e.joinOption,callback:function(t){e.joinOption=t},expression:"joinOption"}},[n("el-option",{attrs:{label:"自由加入",value:"FreeAccess"}}),n("el-option",{attrs:{label:"需要验证",value:"NeedPermission"}}),n("el-option",{attrs:{label:"禁止加群",value:"DisableApply"}})],1)],1):e._e(),n("div",{staticClass:"info-item"},[n("div",{staticClass:"label"},[e._v("\n      群消息提示类型\n      "),e.editable?n("i",{staticClass:"el-icon-edit",on:{click:function(t){e.showEditMessageRemindType=!0,e.inputFocus("editMessageRemindType")}}}):e._e()]),n("div",{directives:[{name:"show",rawName:"v-show",value:!e.showEditMessageRemindType,expression:"!showEditMessageRemindType"}],staticClass:"content"},[e._v(e._s(e.messageRemindTypeMap[this.groupProfile.selfInfo.messageRemindType]))]),n("el-select",{directives:[{name:"show",rawName:"v-show",value:e.showEditMessageRemindType,expression:"showEditMessageRemindType"}],ref:"editMessageRemindType",attrs:{size:"mini","automatic-dropdown":""},on:{change:e.editMessageRemindType,blur:function(t){e.showEditMessageRemindType=!1}},model:{value:e.messageRemindType,callback:function(t){e.messageRemindType=t},expression:"messageRemindType"}},[n("el-option",{attrs:{label:"接收消息并提示",value:"AcceptAndNotify"}}),n("el-option",{attrs:{label:"接收消息但不提示",value:"AcceptNotNotify"}}),n("el-option",{attrs:{label:"屏蔽消息",value:"Discard"}})],1)],1),e.isOwner?n("div",[n("el-button",{attrs:{type:"text"},on:{click:function(t){e.showChangeGroupOwner=!0}}},[e._v("转让群组")]),e.showChangeGroupOwner?n("el-input",{attrs:{placeholder:"新群主的userID",size:"mini"},on:{blur:function(t){e.showChangeGroupOwner=!1}},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.changeOwner(t)}},model:{value:e.newOwnerUserID,callback:function(t){e.newOwnerUserID=t},expression:"newOwnerUserID"}}):e._e()],1):e._e(),n("div",[n("el-button",{staticStyle:{color:"red"},attrs:{type:"text"},on:{click:e.quitGroup}},[e._v("退出群组")])],1),e.showDissmissGroup?n("div",[n("el-button",{staticStyle:{color:"red"},attrs:{type:"text"},on:{click:e.dismissGroup}},[e._v("解散群组")])],1):e._e()],1)},St=[],Lt=(n("6611"),n("e772")),Gt=n.n(Lt),Rt=(n("1f1a"),n("4e4b")),$t=n.n(Rt),Nt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"group-member-list-wrapper"},[n("div",{staticClass:"group-member-list"},[n("popover",{model:{value:e.addGroupMemberVisible,callback:function(t){e.addGroupMemberVisible=t},expression:"addGroupMemberVisible"}},[n("add-group-member"),n("div",{staticClass:"add-group-member group-member",attrs:{slot:"reference"},slot:"reference"},[n("span",{staticClass:"el-icon-plus add-button",staticStyle:{width:"30px",height:"30px"},attrs:{circle:""}}),n("span",[e._v("Add")])])],1),e._l(e.members,function(t){return[n("popover",{key:t.userID,attrs:{placement:"right"}},[n("group-member-info",{attrs:{member:t}}),n("div",{staticClass:"group-member",attrs:{slot:"reference"},on:{click:function(n){e.currentMemberID=t.userID}},slot:"reference"},[n("avatar",{attrs:{src:t.avatar,text:e.getGroupMemberAvatarText(t.role),shape:"square"}}),t.nameCard?n("span",{staticClass:"member-name"},[e._v(e._s(t.nameCard))]):t.nick?n("span",{staticClass:"member-name"},[e._v(e._s(t.nick))]):n("span",{staticClass:"member-name"},[e._v(e._s(t.userID))])],1)],1)]})],2),e.showLoadMore?n("el-button",{attrs:{type:"text"},on:{click:e.loadMore}},[e._v("查看更多")]):e._e()],1)},Ut=[],At=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-input",{attrs:{placeholder:"输入userID后 按回车键"},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.addGroupMember(t)}},model:{value:e.userID,callback:function(t){e.userID=t},expression:"userID"}})],1)},Bt=[];n("a481");function Ft(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Vt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ft(n,!0).forEach(function(t){Object(S["a"])(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ft(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Yt={components:{ElInput:c.a},data:function(){return{userID:""}},computed:Vt({},Object(L["c"])({currentConversation:function(e){return e.conversation.currentConversation}})),methods:{addGroupMember:function(){var e=this;this.tim.addGroupMember({groupID:this.currentConversation.conversationID.replace("GROUP",""),userIDList:[this.userID]}).then(function(t){var n=t.data,r=n.successUserIDList,o=n.failureUserIDList,i=n.existedUserIDList;r.length>0&&e.$message({message:"群成员：".concat(r.join(","),"，加群成功"),type:"success"}),o.length>0&&e.$message.error("群成员：".concat(o.join(","),"，添加失败！")),i.length>0&&e.$message({message:"群成员：".concat(i.join(","),"，已在群中")})})}}},qt=Yt,zt=Object(I["a"])(qt,At,Bt,!1,null,null,null),Kt=zt.exports,Jt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",[n("span",{staticClass:"label"},[e._v("userID:")]),e._v("\n    "+e._s(e.member.userID)+"\n    "),e.showCancelBan?n("el-button",{attrs:{type:"text"},on:{click:e.cancelMute}},[e._v("取消禁言")]):e._e(),n("el-popover",{directives:[{name:"show",rawName:"v-show",value:e.showBan,expression:"showBan"}],attrs:{title:"禁言"},model:{value:e.popoverVisible,callback:function(t){e.popoverVisible=t},expression:"popoverVisible"}},[n("el-input",{attrs:{placeholder:"请输入禁言时间"},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.setGroupMemberMuteTime(t)}},model:{value:e.muteTime,callback:function(t){e.muteTime=t},expression:"muteTime"}}),n("el-button",{staticStyle:{color:"red"},attrs:{slot:"reference",type:"text"},slot:"reference"},[e._v("禁言")])],1)],1),n("div",[n("span",{staticClass:"label"},[e._v("nick:")]),e._v("\n    "+e._s(e.member.nick||"暂无")+"\n  ")]),n("div",[n("span",{staticClass:"label"},[e._v("nameCard:")]),e._v("\n    "+e._s(e.member.nameCard||"暂无")+"\n    "),n("el-popover",{directives:[{name:"show",rawName:"v-show",value:e.showEditNameCard,expression:"showEditNameCard"}],attrs:{title:"修改群名片"},model:{value:e.nameCardPopoverVisible,callback:function(t){e.nameCardPopoverVisible=t},expression:"nameCardPopoverVisible"}},[n("el-input",{attrs:{placeholder:"请输入群名片"},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.setGroupMemberNameCard(t)}},model:{value:e.nameCard,callback:function(t){e.nameCard=t},expression:"nameCard"}}),n("i",{staticClass:"el-icon-edit",staticStyle:{cursor:"pointer","font-size":"1.6rem"},attrs:{slot:"reference",title:"修改群名片"},slot:"reference"})],1)],1),n("div",[n("span",{staticClass:"label"},[e._v("role:")]),n("span",{staticClass:"content role",attrs:{title:e.changeRoleTitle}},[e._v(e._s(e.member.role))])]),e.showMuteUntil?n("div",[n("span",{staticClass:"label"},[e._v("禁言至:")]),n("span",{staticClass:"content"},[e._v(e._s(e.muteUntil))])]):e._e(),e.canChangeRole?n("el-button",{attrs:{type:"text"},on:{click:e.changeMemberRole}},[e._v(e._s("Admin"===e.member.role?"取消管理员":"设为管理员"))]):e._e(),e.showKickout?n("el-button",{staticStyle:{color:"red"},attrs:{type:"text"},on:{click:e.kickoutGroupMember}},[e._v("踢出群组")]):e._e()],1)},Ht=[];function Wt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Zt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Wt(n,!0).forEach(function(t){Object(S["a"])(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Wt(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Xt={components:{ElPopover:Y.a},props:["member"],data:function(){return{muteTime:"",popoverVisible:!1,nameCardPopoverVisible:!1,nameCard:this.member.nameCard}},computed:Zt({},Object(L["c"])({currentConversation:function(e){return e.conversation.currentConversation},currentUserProfile:function(e){return e.user.currentUserProfile},current:function(e){return e.current}}),{showKickout:function(){return(this.isOwner||this.isAdmin)&&!this.isMine},isOwner:function(){return"Owner"===this.currentConversation.groupProfile.selfInfo.role},isAdmin:function(){return"Admin"===this.currentConversation.groupProfile.selfInfo.role},isMine:function(){return this.currentUserProfile.userID===this.member.userID},canChangeRole:function(){return this.isOwner&&["ChatRoom","Public"].includes(this.currentConversation.subType)},changeRoleTitle:function(){return this.canChangeRole?this.isOwner&&"Admin"===this.member.role?"设为：Member":"设为：Admin":""},showMuteUntil:function(){return 1e3*this.member.muteUntil>this.current},showCancelBan:function(){return!(!this.showMuteUntil||this.currentConversation.type!==this.TIM.TYPES.CONV_GROUP||this.isMine)&&(this.isOwner||this.isAdmin)},showBan:function(){return this.currentConversation.type===this.TIM.TYPES.CONV_GROUP&&(this.isOwner||this.isAdmin)},showEditNameCard:function(){return this.isOwner||this.isAdmin},muteUntil:function(){return ge(new Date(1e3*this.member.muteUntil))}}),methods:{kickoutGroupMember:function(){this.tim.deleteGroupMember({groupID:this.currentConversation.groupProfile.groupID,reason:"我要踢你出群",userIDList:[this.member.userID]})},changeMemberRole:function(){if(this.canChangeRole){var e=this.member.role;this.tim.setGroupMemberRole({groupID:this.currentConversation.groupProfile.groupID,userID:this.member.userID,role:"Admin"===e?"Member":"Admin"})}},setGroupMemberMuteTime:function(){var e=this;this.tim.setGroupMemberMuteTime({groupID:this.currentConversation.groupProfile.groupID,userID:this.member.userID,muteTime:Number(this.muteTime)}).then(function(){e.muteTime="",e.popoverVisible=!1})},cancelMute:function(){var e=this;this.tim.setGroupMemberMuteTime({groupID:this.currentConversation.groupProfile.groupID,userID:this.member.userID,muteTime:0}).then(function(){e.muteTime=""})},setGroupMemberNameCard:function(){var e=this;0!==this.nameCard.trim().length?this.tim.setGroupMemberNameCard({groupID:this.currentConversation.groupProfile.groupID,userID:this.member.userID,nameCard:this.nameCard}).then(function(){e.nameCardPopoverVisible=!1,e.$message({message:"修改成功",type:"success"})}):this.$message.warning("不能设置空的群名片")}}},Qt=Xt,en=(n("61d3"),Object(I["a"])(Qt,Jt,Ht,!1,null,"3462c904",null)),tn=en.exports;function nn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function rn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nn(n,!0).forEach(function(t){Object(S["a"])(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nn(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var on={data:function(){return{addGroupMemberVisible:!1,currentMemberID:"",count:30}},props:["groupProfile"],components:{Popover:Y.a,AddGroupMember:Kt,GroupMemberInfo:tn},computed:rn({},Object(L["c"])({currentConversation:function(e){return e.conversation.currentConversation},currentMemberList:function(e){return e.group.currentMemberList}}),{showLoadMore:function(){return this.members.length<this.groupProfile.memberNum},members:function(){return this.currentMemberList.slice(0,this.count)}}),methods:{getGroupMemberAvatarText:function(e){switch(e){case"Owner":return"主";case"Admin":return"管";default:return"普"}},loadMore:function(){var e=this;this.$store.dispatch("getGroupMemberList",this.groupProfile.groupID).then(function(){e.count+=30})}}},sn=on,an=(n("6ec7"),Object(I["a"])(sn,Nt,Ut,!1,null,"15ced72a",null)),cn=an.exports,ln={props:["groupProfile"],components:{GroupMemberList:cn,ElSelect:$t.a,ElOption:Gt.a},data:function(){return{showEditName:!1,showEditFaceUrl:!1,showEditIntroduction:!1,showEditNotification:!1,showEditJoinOption:!1,showChangeGroupOwner:!1,showEditMessageRemindType:!1,showEditNameCard:!1,name:this.groupProfile.name,avatar:this.groupProfile.avatar,introduction:this.groupProfile.introduction,notification:this.groupProfile.notification,joinOption:this.groupProfile.joinOption,newOwnerUserID:"",messageRemindType:this.groupProfile.selfInfo.messageRemindType,nameCard:this.groupProfile.selfInfo.nameCard||"",messageRemindTypeMap:{AcceptAndNotify:"接收消息并提示",AcceptNotNotify:"接收消息但不提示",Discard:"屏蔽消息"},joinOptionMap:{FreeAccess:"自由加入",NeedPermission:"需要验证",DisableApply:"禁止加群"}}},computed:{editable:function(){return this.groupProfile.type===this.TIM.TYPES.GRP_PRIVATE||["Owner","Admin"].includes(this.groupProfile.selfInfo.role)},joinOptionEditable:function(){return this.editable&&this.groupProfile.type===this.TIM.TYPES.GRP_PUBLIC},isOwner:function(){return"Owner"===this.groupProfile.selfInfo.role},showDissmissGroup:function(){return this.isOwner&&"Private"!==this.groupProfile.type}},watch:{groupProfile:function(e){Object.assign(this,{showEditName:!1,showEditFaceUrl:!1,showEditIntroduction:!1,showEditNotification:!1,showEditJoinOption:!1,showChangeGroupOwner:!1,showEditNameCard:!1,name:e.name,avatar:e.avatar,introduction:e.introduction,notification:e.notification,joinOption:e.joinOption,messageRemindType:e.messageRemindType,nameCard:e.selfInfo.nameCard||""})}},methods:{inputFocus:function(e){var t=this;this.$nextTick(function(){t.$refs[e].focus()})},editName:function(){var e=this;this.tim.updateGroupProfile({groupID:this.groupProfile.groupID,name:this.name.trim()}).then(function(){e.showEditName=!1})},editFaceUrl:function(){var e=this;this.tim.updateGroupProfile({groupID:this.groupProfile.groupID,avatar:this.avatar.trim()}).then(function(){e.showEditFaceUrl=!1})},editIntroduction:function(){var e=this;this.tim.updateGroupProfile({groupID:this.groupProfile.groupID,introduction:this.introduction.trim()}).then(function(){e.showEditIntroduction=!1})},editNotification:function(){var e=this;this.tim.updateGroupProfile({groupID:this.groupProfile.groupID,notification:this.notification.trim()}).then(function(){e.showEditNotification=!1})},editJoinOption:function(){var e=this;this.tim.updateGroupProfile({groupID:this.groupProfile.groupID,joinOption:this.joinOption}).then(function(){e.showEditJoinOption=!1})},changeOwner:function(){var e=this;this.tim.changeGroupOwner({groupID:this.groupProfile.groupID,newOwnerID:this.newOwnerUserID}).then(function(){e.showChangeGroupOwner=!1,e.$message({message:"转让群主成功，新群主ID：".concat(e.newOwnerUserID)}),e.newOwnerUserID=""})},quitGroup:function(){var e=this;this.tim.quitGroup(this.groupProfile.groupID).then(function(t){var n=t.data.groupID;e.$message({message:"退群成功",type:"success"}),n===e.groupProfile.groupID&&e.$store.commit("resetCurrentConversation")})},dismissGroup:function(){var e=this;this.tim.dismissGroup(this.groupProfile.groupID).then(function(t){var n=t.data.groupID;e.$message({message:"群：".concat(e.groupProfile.name||e.groupProfile.groupID,"解散成功！"),type:"success"}),n===e.groupProfile.groupID&&e.$store.commit("resetCurrentConversation")})},editMessageRemindType:function(){var e=this;this.tim.setMessageRemindType({groupID:this.groupProfile.groupID,messageRemindType:this.messageRemindType}).then(function(){e.showEditMessageRemindType=!1})},editNameCard:function(){var e=this;0!==this.nameCard.trim().length?this.tim.setGroupMemberNameCard({groupID:this.groupProfile.groupID,nameCard:this.nameCard.trim()}).then(function(){e.showEditNameCard=!1}):this.$message.warning("不能设置空的群名片")}}},un=ln,pn=(n("e336"),Object(I["a"])(un,Tt,St,!1,null,null,null)),mn=pn.exports,fn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"info-item"},[n("div",{staticClass:"label"},[e._v("userID")]),n("div",{staticClass:"content"},[e._v(e._s(e.userProfile.userID))])]),n("div",{staticClass:"info-item"},[n("div",{staticClass:"label"},[e._v("头像")]),n("div",{staticClass:"content"},[n("avatar",{attrs:{src:e.userProfile.avatar,text:e.userProfile.userID}})],1)]),n("div",{staticClass:"info-item"},[n("div",{staticClass:"label"},[e._v("昵称")]),n("div",{staticClass:"content"},[e._v(e._s(e.userProfile.nick||"暂无"))])]),n("div",{staticClass:"info-item"},[n("div",{staticClass:"label"},[e._v("性别")]),n("div",{staticClass:"content"},[e._v(e._s(e.gender))])]),e.isInBlacklist||e.userProfile.userID===e.myUserID?e.isInBlacklist?n("el-button",{attrs:{type:"text"},on:{click:e.removeFromBlacklist}},[e._v("取消拉黑")]):e._e():n("el-button",{staticStyle:{color:"red"},attrs:{type:"text"},on:{click:e.addToBlackList}},[e._v("拉黑")])],1)},dn=[];function hn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function gn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?hn(n,!0).forEach(function(t){Object(S["a"])(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hn(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var vn={props:{userProfile:{type:Object,required:!0}},computed:gn({},Object(L["c"])({blacklist:function(e){return e.blacklist.blacklist},myUserID:function(e){return e.user.currentUserProfile.userID}}),{isInBlacklist:function(){var e=this;return this.blacklist.findIndex(function(t){return t.userID===e.userProfile.userID})>=0},gender:function(){switch(this.userProfile.gender){case this.TIM.TYPES.GENDER_MALE:return"男";case this.TIM.TYPES.GENDER_FEMALE:return"女";default:return"未设置"}}}),methods:{addToBlackList:function(){var e=this;this.tim.addToBlacklist({userIDList:[this.userProfile.userID]}).then(function(){e.$store.dispatch("getBlacklist")}).catch(function(t){e.$message.error(t.message)})},removeFromBlacklist:function(){var e=this;this.tim.removeFromBlacklist({userIDList:[this.userProfile.userID]}).then(function(){e.$store.commit("removeFromBlacklist",e.userProfile.userID)})}}},bn=vn,yn=(n("f39d"),Object(I["a"])(bn,fn,dn,!1,null,"67144a27",null)),On=yn.exports;function Cn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function wn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Cn(n,!0).forEach(function(t){Object(S["a"])(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Cn(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var _n={name:"ConversationProfile",components:{GroupProfile:mn,UserProfile:On},data:function(){return{}},computed:wn({},Object(L["c"])({currentConversation:function(e){return e.conversation.currentConversation}}))},jn=_n,Pn=(n("e8a0"),Object(I["a"])(jn,Mt,kt,!1,null,"091f4a45",null)),In=Pn.exports,Dn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"show",rawName:"v-show",value:e.showPreviewer,expression:"showPreviewer"}],staticClass:"image-previewer-wrapper",on:{mousewheel:e.handleMouseWheel}},[n("div",{staticClass:"image-wrapper"},[n("img",{staticClass:"image-preview",style:{transform:"scale("+e.zoom+") rotate("+e.rotate+"deg)"},attrs:{src:e.previewUrl},on:{click:e.close}})]),n("i",{staticClass:"el-icon-close close-button",on:{click:e.close}}),n("i",{staticClass:"el-icon-back prev-button",on:{click:e.goPrev}}),n("i",{staticClass:"el-icon-right next-button",on:{click:e.goNext}}),n("div",{staticClass:"actions-bar"},[n("i",{staticClass:"el-icon-zoom-out",on:{click:e.zoomOut}}),n("i",{staticClass:"el-icon-zoom-in",on:{click:e.zoomIn}}),n("i",{staticClass:"el-icon-refresh-left",on:{click:e.rotateLeft}}),n("i",{staticClass:"el-icon-refresh-right",on:{click:e.rotateRight}}),n("span",{staticClass:"image-counter"},[e._v(e._s(e.index+1)+" / "+e._s(e.imgUrlList.length))])])])},xn=[];function En(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Mn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?En(n,!0).forEach(function(t){Object(S["a"])(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):En(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var kn={name:"ImagePreviewer",data:function(){return{url:"",index:0,visible:!1,zoom:1,rotate:0,minZoom:.1}},computed:Mn({},Object(L["b"])(["imgUrlList"]),{showPreviewer:function(){return this.url.length>0&&this.visible},imageStyle:function(){return{transform:"scale(".concat(this.zoom,");")}},previewUrl:function(){return this.formatUrl(this.imgUrlList[this.index])}}),mounted:function(){this.$bus.$on("image-preview",this.handlePreview)},methods:{handlePreview:function(e){var t=e.url;this.url=t,this.index=this.imgUrlList.findIndex(function(e){return e===t}),this.visible=!0},handleMouseWheel:function(e){e.wheelDelta>0?this.zoomIn():this.zoomOut()},zoomIn:function(){this.zoom+=.1},zoomOut:function(){this.zoom=this.zoom-.1>this.minZoom?this.zoom-.1:this.minZoom},close:function(){Object.assign(this,{zoom:1}),this.visible=!1},rotateLeft:function(){this.rotate-=90},rotateRight:function(){this.rotate+=90},goNext:function(){this.index=(this.index+1)%this.imgUrlList.length},goPrev:function(){this.index=this.index-1>=0?this.index-1:this.imgUrlList.length-1},formatUrl:function(e){return e?"//"===e.slice(0,2)?"https:".concat(e):e:""}}},Tn=kn,Sn=(n("99f2"),Object(I["a"])(Tn,Dn,xn,!1,null,"41c2a992",null)),Ln=Sn.exports;function Gn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Rn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Gn(n,!0).forEach(function(t){Object(S["a"])(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Gn(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var $n={name:"CurrentConversation",components:{MessageSendBox:re,MessageItem:Et,ConversationProfile:In,ImagePreviewer:Ln},data:function(){return{isShowScrollButtomTips:!1,preScrollHeight:0,showConversationProfile:!1}},computed:Rn({},Object(L["c"])({currentConversation:function(e){return e.conversation.currentConversation},currentMessageList:function(e){return e.conversation.currentMessageList}}),{},Object(L["b"])(["toAccount"]),{showCurrentConversation:function(){return!!this.currentConversation.conversationID},name:function(){return"C2C"===this.currentConversation.type?this.currentConversation.userProfile.nick||this.toAccount:"GROUP"===this.currentConversation.type&&this.currentConversation.groupProfile.name||this.toAccount},showMessageSendBox:function(){return this.currentConversation.type!==this.TIM.TYPES.CONV_SYSTEM}}),mounted:function(){this.$bus.$on("image-loaded",this.onImageLoaded),this.$bus.$on("scroll-bottom",this.scrollMessageListToButtom)},updated:function(){this.keepMessageListOnButtom()},methods:{onScroll:function(e){var t=e.target.scrollTop,n=this.$refs["message-list"];n&&this.preScrollHeight-n.clientHeight-t<20&&(this.isShowScrollButtomTips=!1)},keepMessageListOnButtom:function(){var e=this.$refs["message-list"];e&&(this.preScrollHeight-e.clientHeight-e.scrollTop<20?(this.$nextTick(function(){e.scrollTop=e.scrollHeight}),this.isShowScrollButtomTips=!1):this.isShowScrollButtomTips=!0,this.preScrollHeight=e.scrollHeight)},scrollMessageListToButtom:function(){var e=this;this.$nextTick(function(){var t=e.$refs["message-list"];t&&(t.scrollTop=t.scrollHeight,e.preScrollHeight=t.scrollHeight,e.isShowScrollButtomTips=!1)})},showMore:function(){this.showConversationProfile=!this.showConversationProfile},onImageLoaded:function(){this.keepMessageListOnButtom()}}},Nn=$n,Un=(n("a4fd"),Object(I["a"])(Nn,G,R,!1,null,"1015e145",null)),An=Un.exports,Bn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"side-bar-wrapper"},[n("div",{staticClass:"bar-header"},[n("my-profile"),n("div",{staticClass:"tab-items",on:{click:e.handleClick}},[n("el-badge",{attrs:{value:e.totalUnreadCount,max:99,hidden:0===e.totalUnreadCount}},[n("span",{staticClass:"iconfont icon-conversation",class:{active:e.showConversationList},attrs:{id:"conversation-list",title:"会话列表"}})]),n("span",{staticClass:"iconfont icon-group",class:{active:e.showGroupList},attrs:{id:"group-list",title:"群组列表"}}),n("span",{staticClass:"iconfont icon-contact",class:{active:e.showFriendList},attrs:{id:"friend-list",title:"好友列表"}}),n("span",{staticClass:"iconfont icon-blacklist",class:{active:e.showBlackList},attrs:{id:"black-list",title:"黑名单列表"}})],1),n("el-popover",{attrs:{placement:"right",trigger:"click","visible-arrow":!1}},[n("el-button",{attrs:{type:"text"},on:{click:function(t){return e.$store.dispatch("logout")}}},[e._v("退出")]),n("div",{staticClass:"more el-icon-s-operation",attrs:{slot:"reference",title:"更多"},slot:"reference"})],1)],1),n("div",{staticClass:"bar-content"},[n("conversation-list",{directives:[{name:"show",rawName:"v-show",value:e.showConversationList,expression:"showConversationList"}]}),n("group-list",{directives:[{name:"show",rawName:"v-show",value:e.showGroupList,expression:"showGroupList"}]}),n("friend-list",{directives:[{name:"show",rawName:"v-show",value:e.showFriendList,expression:"showFriendList"}]}),n("black-list",{directives:[{name:"show",rawName:"v-show",value:e.showBlackList,expression:"showBlackList"}]})],1)])},Fn=[],Vn=(n("e2f3"),n("06f9")),Yn=n.n(Vn),qn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"my-profile-wrapper"},[n("el-dialog",{attrs:{title:"编辑个人资料",visible:e.showEditMyProfile},on:{"update:visible":function(t){e.showEditMyProfile=t}}},[n("el-form",{attrs:{"label-width":"100px"},model:{value:e.form,callback:function(t){e.form=t},expression:"form"}},[n("el-form-item",{attrs:{label:"头像"}},[n("el-input",{attrs:{placeholder:"头像地址(URL)"},model:{value:e.form.avatar,callback:function(t){e.$set(e.form,"avatar",t)},expression:"form.avatar"}})],1),n("el-form-item",{attrs:{label:"昵称"}},[n("el-input",{attrs:{placeholder:"昵称"},model:{value:e.form.nick,callback:function(t){e.$set(e.form,"nick",t)},expression:"form.nick"}})],1),n("el-form-item",{attrs:{label:"性别"}},[n("el-radio-group",{model:{value:e.form.gender,callback:function(t){e.$set(e.form,"gender",t)},expression:"form.gender"}},[n("el-radio",{attrs:{label:e.TIM.TYPES.GENDER_MALE}},[e._v("男")]),n("el-radio",{attrs:{label:e.TIM.TYPES.GENDER_FEMALE}},[e._v("女")]),n("el-radio",{attrs:{label:e.TIM.TYPES.GENDER_UNKNOWN}},[e._v("不显示")])],1)],1)],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.showEditMyProfile=!1}}},[e._v("取 消")]),n("el-button",{attrs:{type:"primary"},on:{click:e.editMyProfile}},[e._v("确 定")])],1)],1),n("el-popover",{attrs:{width:200,trigger:"click",placement:"right"}},[n("profile-card",{attrs:{profile:e.currentUserProfile}}),n("el-button",{attrs:{type:"text"},on:{click:e.handleEdit}},[e._v("编辑")]),n("avatar",{staticClass:"my-avatar",attrs:{slot:"reference",shape:"square",src:e.currentUserProfile.avatar,text:"U"},slot:"reference"})],1)],1)},zn=[],Kn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"profile-card-wrapper"},[n("div",{staticClass:"profile-header"},[n("avatar",{attrs:{src:e.profile.avatar,shape:"square",text:"U"}}),n("div",{staticClass:"basic"},[n("span",{staticClass:"nick text-ellipsis"},[e._v(e._s(e.profile.nick||e.profile.userID))]),n("span",{staticClass:"iconfont",class:e.genderClass}),n("div",[e._v("ID:"+e._s(e.profile.userID))])])],1)])},Jn=[],Hn={name:"ProfileCard",props:{profile:{type:Object,required:!0}},computed:{genderClass:function(){switch(this.profile.gender){case this.TIM.TYPES.GENDER_MALE:return"icon-male";case this.TIM.TYPES.GENDER_FEMALE:return"icon-female";default:return"暂无"}}}},Wn=Hn,Zn=(n("f095"),Object(I["a"])(Wn,Kn,Jn,!1,null,null,null)),Xn=Zn.exports;function Qn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function er(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qn(n,!0).forEach(function(t){Object(S["a"])(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qn(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var tr={name:"MyProfile",components:{ElPopover:Y.a,ProfileCard:Xn,ElForm:J.a,ElFormItem:z.a,ElRadioGroup:F.a,ElRadio:A.a},data:function(){return{showEditMyProfile:!1,form:{avatar:"",nick:"",gender:""}}},computed:er({},Object(L["c"])({currentUserProfile:function(e){return e.user.currentUserProfile},currentConversation:function(e){return e.conversation.currentConversation}}),{gender:function(){switch(this.currentUserProfile.gender){case this.TIM.TYPES.GENDER_MALE:return"男";case this.TIM.TYPES.GENDER_FEMALE:return"女";default:return"暂无"}}}),methods:{editMyProfile:function(){var e=this,t={};Object.keys(this.form).forEach(function(n){e.form[n]&&(t[n]=e.form[n])}),this.tim.updateMyProfile(t).then(function(){e.$message({message:"修改成功",type:"success"}),e.showEditMyProfile=!1}).catch(function(t){e.$message.error(t.message)})},handleEdit:function(){var e=this.currentUserProfile,t=e.avatar,n=e.nick,r=e.gender;Object.assign(this.form,{avatar:t,nick:n,gender:r}),this.showEditMyProfile=!0}}},nr=tr,rr=(n("df23"),Object(I["a"])(nr,qn,zn,!1,null,"4abc710f",null)),or=rr.exports,ir=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"list-container",attrs:{id:"conversation-list"}},[e._l(e.conversationList,function(t){return n("conversation-item",{key:t.conversationID,class:{"current-conversation-item":t.conversationID===e.currentConversation.conversationID},attrs:{conversation:t}})}),n("el-button",{staticClass:"bottom-circle-btn create-conversation",attrs:{icon:"el-icon-plus",circle:"",title:"发起会话"},on:{click:e.handleAddButtonClick}}),n("el-button",{staticClass:"bottom-circle-btn refresh",attrs:{type:"primary",icon:"el-icon-refresh-right",circle:""},on:{click:e.handleRefresh}}),n("el-dialog",{attrs:{title:"快速发起会话",visible:e.showDialog},on:{"update:visible":function(t){e.showDialog=t}}},[n("el-input",{attrs:{placeholder:"请输入用户ID"},model:{value:e.userID,callback:function(t){e.userID=t},expression:"userID"}}),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.showDialog=!1}}},[e._v("取 消")]),n("el-button",{attrs:{type:"primary"},on:{click:e.handleConfirm}},[e._v("确 定")])],1)],1)],2)},sr=[],ar=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("popover",{staticStyle:{display:"flex","flex-direction":"column",padding:"0 12px"},attrs:{placement:"top",trigger:"manual"},model:{value:e.popoverVisible,callback:function(t){e.popoverVisible=t},expression:"popoverVisible"}},[n("el-button",{staticClass:"context-menu-button",attrs:{type:"text"},on:{click:e.deleteConversation}},[e._v("删除")]),n("el-button",{staticClass:"context-menu-button",attrs:{type:"text"},on:{click:function(t){e.popoverVisible=!1}}},[e._v("取消")]),n("div",{staticClass:"conversation-item-container",attrs:{slot:"reference"},on:{contextmenu:function(t){t.preventDefault(),e.popoverVisible=!0},click:e.selectConversation},slot:"reference"},[n("el-row",{attrs:{gutter:30}},[n("el-col",{attrs:{span:4}},[n("avatar",{attrs:{shape:"square",src:e.avatar,text:e.conversation.type}})],1),n("el-col",{attrs:{span:20}},[n("div",{staticClass:"conversation-item"},[n("div",{staticClass:"item-header"},[e.conversation.type===e.TIM.TYPES.CONV_C2C?n("div",{staticClass:"covnersation-info text-ellipsis"},[e._v(e._s(e.conversation.userProfile.nick||e.conversation.userProfile.userID))]):e.conversation.type===e.TIM.TYPES.CONV_GROUP?n("div",{staticClass:"covnersation-info text-ellipsis"},[e._v(e._s(e.conversation.groupProfile.name||e.conversation.groupProfile.groupID))]):e.conversation.type===e.TIM.TYPES.CONV_SYSTEM?n("div",{staticClass:"covnersation-info text-ellipsis"},[e._v("系统通知")]):e._e(),e.showUnreadCount?n("badge",{attrs:{max:99,type:e.showGrayBadge?"info":"danger",value:e.conversation.unreadCount}}):e._e()],1),e.conversation.lastMessage?n("div",{staticClass:"conversation-message"},[n("span",{staticClass:"message-for-show"},[e.hasMessageAtMe?n("span",{staticStyle:{color:"red"}},[e._v("[有人提到我]")]):e._e(),e._v("\n              "+e._s(e.conversation.lastMessage.messageForShow)+"\n            ")]),n("span",{staticClass:"message-time"},[e._v(e._s(e.date))])]):e._e()])])],1)],1)],1)},cr=[];function lr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ur(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?lr(n,!0).forEach(function(t){Object(S["a"])(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lr(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var pr={name:"conversation-item",props:["conversation"],components:{Badge:Yn.a,Popover:Y.a,ElButton:d.a},data:function(){return{popoverVisible:!1,hasMessageAtMe:!1}},computed:ur({showUnreadCount:function(){return this.currentConversation.conversationID!==this.conversation.conversationID&&this.conversation.unreadCount>0},date:function(){if(!this.conversation.lastMessage||!this.conversation.lastMessage.lastTime)return"";var e=new Date(1e3*this.conversation.lastMessage.lastTime);return ve(e)?he(e):de(e)},avatar:function(){switch(this.conversation.type){case"GROUP":return this.conversation.groupProfile.avatar;case"C2C":return this.conversation.userProfile.avatar;default:return""}},showGrayBadge:function(){return this.conversation.type===this.TIM.TYPES.CONV_GROUP&&"AcceptNotNotify"===this.conversation.groupProfile.selfInfo.messageRemindType}},Object(L["c"])({currentConversation:function(e){return e.conversation.currentConversation}}),{},Object(L["b"])(["toAccount"])),mounted:function(){var e=this;this.$bus.$on("new-messsage-at-me",function(t){t.data.conversationID===e.conversation.conversationID&&e.conversation.conversationID!==e.currentConversation.conversationID&&(e.hasMessageAtMe=!0)})},methods:{selectConversation:function(){this.$store.dispatch("checkoutConversation",this.conversation.conversationID)},deleteConversation:function(){var e=this;this.tim.deleteConversation(this.conversation.conversationID).then(function(){e.$message({message:"会话".concat(e.conversation.conversationID,"删除成功!"),type:"success"}),e.popoverVisible=!1,e.$store.commit("resetCurrentConversation")}).catch(function(t){e.$message.error("会话".concat(e.conversation.conversationID,"删除失败!, error=").concat(t.message)),e.popoverVisible=!1})},showContextMenu:function(){this.popoverVisible=!0},setMessageRead:function(){0!==this.conversation.unreadCount&&("C2C"===this.conversation.type?this.tim.setMessageRead({conversationID:this.conversation.conversationID,lastMessageTime:this.conversation.lastMessage.lastTime}):"GROUP"===this.conversation.type&&this.tim.setMessageRead({conversationID:this.conversation.conversationID,lastMessageSeq:this.conversation.lastMessage.lastSequence}))}},watch:{currentConversation:function(e){e.conversationID===this.conversation.conversationID&&(this.hasMessageAtMe=!1)}}},mr=pr,fr=(n("d67e"),Object(I["a"])(mr,ar,cr,!1,null,"21d203a0",null)),dr=fr.exports;function hr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function gr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?hr(n,!0).forEach(function(t){Object(S["a"])(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hr(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var vr={name:"ConversationList",components:{ConversationItem:dr},data:function(){return{showDialog:!1,userID:"",isCheckouting:!1}},computed:gr({},Object(L["c"])({conversationList:function(e){return e.conversation.conversationList},currentConversation:function(e){return e.conversation.currentConversation}})),mounted:function(){window.addEventListener("keydown",this.handleKeydown)},destroyed:function(){window.removeEventListener("keydown",this.handleKeydown)},methods:{handleRefresh:function(){this.tim.getConversationList()},handleAddButtonClick:function(){this.showDialog=!0},handleConfirm:function(){var e=this;this.$store.dispatch("checkoutConversation","C2C".concat(this.userID)).then(function(){e.showDialog=!1})},handleKeydown:function(e){var t=this;if(!(38!==e.keyCode&&40!==e.keyCode||this.isCheckouting)){var n=this.conversationList.findIndex(function(e){return e.conversationID===t.currentConversation.conversationID});38===e.keyCode&&n-1>=0&&this.checkoutPrev(n),40===e.keyCode&&n+1<this.conversationList.length&&this.checkoutNext(n)}},checkoutPrev:function(e){var t=this;this.isCheckouting=!0,this.$store.dispatch("checkoutConversation",this.conversationList[e-1].conversationID).then(function(){t.isCheckouting=!1}).catch(function(){t.isCheckouting=!1})},checkoutNext:function(e){var t=this;this.isCheckouting=!0,this.$store.dispatch("checkoutConversation",this.conversationList[e+1].conversationID).then(function(){t.isCheckouting=!1}).catch(function(){t.isCheckouting=!1})}}},br=vr,yr=(n("6c81"),Object(I["a"])(br,ir,sr,!1,null,null,null)),Or=yr.exports,Cr=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"list-container"},[n("div",{staticClass:"group-container"},[n("div",{staticClass:"header-bar"},[n("el-autocomplete",{staticClass:"group-seach-bar",attrs:{"value-key":"name",debounce:500,size:"mini",placeholder:"输入群ID搜索","fetch-suggestions":e.searchGroupByID,"prefix-icon":"el-icon-search","hide-loading":e.hideSearchLoading},on:{input:function(t){e.hideSearchLoading=!1},select:e.applyJoinGroup},model:{value:e.groupID,callback:function(t){e.groupID=t},expression:"groupID"}}),n("i",{staticClass:"el-icon-plus create-group-button",attrs:{title:"创建群组"},on:{click:e.showCreateGroupModel}})],1),e._l(e.groupList,function(e){return n("group-item",{key:e.groupID,attrs:{group:e}})}),n("el-dialog",{attrs:{title:"创建群组",visible:e.createGroupModelVisible},on:{close:e.closeCreateGroupModel}},[n("create-group")],1)],2)])},wr=[],_r=(n("3db2"),n("58b8")),jr=n.n(_r),Pr=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-form",{ref:"createGroupForm",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[n("el-form-item",{attrs:{label:"群ID"}},[n("el-input",{model:{value:e.form.groupID,callback:function(t){e.$set(e.form,"groupID",t)},expression:"form.groupID"}})],1),n("el-form-item",{attrs:{label:"群名称",prop:"name"}},[n("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),n("el-form-item",{attrs:{label:"群类型"}},[n("el-select",{model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[n("el-option",{attrs:{label:"Private",value:"Private"}}),n("el-option",{attrs:{label:"Public",value:"Public"}}),n("el-option",{attrs:{label:"ChatRoom",value:"ChatRoom"}}),n("el-option",{attrs:{label:"AVChatRoom",value:"AVChatRoom"}})],1)],1),n("el-form-item",{attrs:{label:"群头像地址"}},[n("el-input",{model:{value:e.form.avatar,callback:function(t){e.$set(e.form,"avatar",t)},expression:"form.avatar"}})],1),n("el-form-item",{attrs:{label:"群简介"}},[n("el-input",{attrs:{type:"textarea",maxlength:240},model:{value:e.form.introduction,callback:function(t){e.$set(e.form,"introduction",t)},expression:"form.introduction"}})],1),n("el-form-item",{attrs:{label:"群公告"}},[n("el-input",{attrs:{type:"textarea",maxlength:300},model:{value:e.form.notification,callback:function(t){e.$set(e.form,"notification",t)},expression:"form.notification"}})],1),n("el-form-item",{attrs:{label:"加群方式"}},[n("el-radio-group",{attrs:{disabled:e.joinOptionDisabled},model:{value:e.form.joinOption,callback:function(t){e.$set(e.form,"joinOption",t)},expression:"form.joinOption"}},[n("el-radio",{attrs:{label:"FreeAccess"}},[e._v("自由加群")]),n("el-radio",{attrs:{label:"NeedPermission"}},[e._v("需要验证")]),n("el-radio",{attrs:{label:"DisableApply"}},[e._v("禁止加群")])],1)],1),n("el-form-item",{attrs:{label:"群成员列表"}},[n("el-select",{attrs:{"default-first-option":"",multiple:"",filterable:"",remote:"",disabled:"AVChatRoom"===e.form.type,"remote-method":e.handleSearchUser,loading:e.loading,placeholder:"请输入群成员 userID"},model:{value:e.form.memberList,callback:function(t){e.$set(e.form,"memberList",t)},expression:"form.memberList"}},e._l(e.options,function(e){return n("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1)],1),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onSubmit("createGroupForm")}}},[e._v("立即创建")]),n("el-button",{on:{click:e.closeCreateGroupModel}},[e._v("取消")])],1)],1)},Ir=[];function Dr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function xr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Dr(n,!0).forEach(function(t){Object(S["a"])(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Dr(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Er={components:{ElForm:J.a,ElFormItem:z.a,ElInput:c.a,ElSelect:$t.a,ElOption:Gt.a,ElRadioGroup:F.a,ElRadio:A.a},data:function(){return{form:{groupID:"",name:"",type:"Private",avatar:"",introduction:"",notification:"",joinOption:"FreeAccess",memberList:[]},options:[],loading:!1,rules:{name:[{required:!0,message:"请输入群名称",trigger:"blur"}]}}},computed:{joinOptionDisabled:function(){return[this.TIM.TYPES.GRP_PRIVATE,this.TIM.TYPES.GRP_CHATROOM,this.TIM.TYPES.GRP_AVCHATROOM].includes(this.form.type)}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.createGroup()})},closeCreateGroupModel:function(){this.$store.commit("updateCreateGroupModelVisible",!1)},createGroup:function(){var e=this;this.tim.createGroup(this.getOptions()).then(function(){e.closeCreateGroupModel()})},getOptions:function(){var e=xr({},this.form,{memberList:this.form.memberList.map(function(e){return{userID:e}})});return["Private","AVChatRoom"].includes(this.form.type)&&delete e.joinOption,e},handleSearchUser:function(e){var t=this;""!==e&&(this.loading=!0,this.tim.getUserProfile({userIDList:[e]}).then(function(e){var n=e.data;t.options=n.map(function(e){return e.userID}),t.loading=!1}))}}},Mr=Er,kr=Object(I["a"])(Mr,Pr,Ir,!1,null,null,null),Tr=kr.exports,Sr=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{on:{click:e.handleGroupClick}},[n("el-row",{staticClass:"group-item-container"},[n("el-col",{attrs:{span:6}},[n("avatar",{attrs:{src:e.group.avatar,text:"G"}})],1),n("el-col",{attrs:{span:18}},[n("div",{staticClass:"group-name"},[e._v(e._s(e.group.name))])])],1)],1)},Lr=[],Gr={props:["group"],data:function(){return{visible:!1,options:[{text:"退出群组",handler:this.quitGroup}]}},methods:{handleGroupClick:function(){var e="GROUP".concat(this.group.groupID);this.$store.dispatch("checkoutConversation",e)},quitGroup:function(){this.tim.quitGroup(this.group.groupID)}}},Rr=Gr,$r=(n("d606"),Object(I["a"])(Rr,Sr,Lr,!1,null,null,null)),Nr=$r.exports;function Ur(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Ar(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ur(n,!0).forEach(function(t){Object(S["a"])(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ur(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Br={data:function(){return{groupID:"",hideSearchLoading:!0}},components:{GroupItem:Nr,ElDialog:o.a,CreateGroup:Tr,ElAutocomplete:jr.a},computed:Ar({groupList:function(){return this.$store.state.group.groupList}},Object(L["c"])({createGroupModelVisible:function(e){return e.group.createGroupModelVisible}})),methods:{onGroupUpdated:function(e){this.$store.dispatch("updateGroupList",e)},createGroup:function(){},closeCreateGroupModel:function(){this.$store.commit("updateCreateGroupModelVisible",!1)},searchGroupByID:function(e,t){var n=this;e.trim().length>0?(this.hideSearchLoading=!1,this.tim.searchGroupByID(e).then(function(e){var n=e.data.group;t([n])}).catch(function(){n.$message("没有找到该群")})):this.hideSearchLoading=!0},showCreateGroupModel:function(){this.$store.commit("updateCreateGroupModelVisible",!0)},applyJoinGroup:function(e){var t=this;this.tim.joinGroup({groupID:e.groupID,type:e.type}).then(function(e){"JoinedSuccess"===e.data.status?t.$message({message:"加群成功",type:"success"}):t.$message.info("申请成功，等待群管理员确认。")}).catch(function(e){t.$message.error(e.error.message)})}}},Fr=Br,Vr=(n("460e"),Object(I["a"])(Fr,Cr,wr,!1,null,"014a5712",null)),Yr=Vr.exports,qr=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"friend-list-container",class:{default:!e.hasFriend}},[e.hasFriend?n("div",e._l(e.friendList,function(e){return n("friend-item",{key:e.userID,attrs:{friend:e}})}),1):n("div",{staticStyle:{color:"gray"}},[e._v("暂无好友")])])},zr=[],Kr=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-row",{staticClass:"friend-item-container"},[n("el-col",{attrs:{span:6}},[n("avatar",{attrs:{src:e.friend.profile.avatar,text:"F"}})],1),n("el-col",{attrs:{span:18}},[n("div",{staticClass:"friend-name"},[e._v(e._s(e.friend.profile.nick||e.friend.userID))])])],1)],1)},Jr=[],Hr={props:{friend:{type:Object,required:!0}},methods:{handleFriendClick:function(){var e=this;this.tim.getConversationProfile("C2C".concat(this.friend.userID)).then(function(t){var n=t.data;e.$store.commit("updateCurrentConversation",n)})}}},Wr=Hr,Zr=Object(I["a"])(Wr,Kr,Jr,!1,null,null,null),Xr=Zr.exports;function Qr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function eo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qr(n,!0).forEach(function(t){Object(S["a"])(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qr(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var to={components:{FriendItem:Xr},computed:eo({},Object(L["c"])({friendList:function(e){return e.friend.friendList}}),{hasFriend:function(){return this.friendList.length>0}})},no=to,ro=(n("96e8"),Object(I["a"])(no,qr,zr,!1,null,null,null)),oo=ro.exports,io=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"blacklist-wrapper",class:{default:!e.hasBlacklist}},[e.hasBlacklist?n("div",e._l(e.blacklist,function(e){return n("blacklist-item",{key:e.userID,staticStyle:{margin:"8px 0"},attrs:{profile:e}})}),1):n("span",{staticStyle:{color:"gray"}},[e._v("黑名单还是空的")])])},so=[],ao=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"blacklist-item-wrapper"},[n("avatar",{attrs:{src:e.profile.avatar,text:"F"}}),n("div",[e._v(e._s(e.profile.nick||e.profile.userID))]),n("el-button",{attrs:{type:"text"},on:{click:e.removeFromBlacklist}},[e._v("取消拉黑")])],1)},co=[],lo={name:"BlacklistItem",props:{profile:{type:Object,required:!0}},methods:{removeFromBlacklist:function(){var e=this;this.tim.removeFromBlacklist({userIDList:[this.profile.userID]}).then(function(){e.$store.commit("removeFromBlacklist",e.profile.userID)})}}},uo=lo,po=(n("59c8"),Object(I["a"])(uo,ao,co,!1,null,"4ec3768e",null)),mo=po.exports;function fo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ho(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fo(n,!0).forEach(function(t){Object(S["a"])(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fo(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var go={name:"Blacklist",components:{BlacklistItem:mo},computed:ho({},Object(L["c"])({blacklist:function(e){return e.blacklist.blacklist}}),{hasBlacklist:function(){return this.blacklist.length>0}})},vo=go,bo=(n("59f0"),Object(I["a"])(vo,io,so,!1,null,null,null)),yo=bo.exports;function Oo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Co(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Oo(n,!0).forEach(function(t){Object(S["a"])(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Oo(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var wo={CONVERSATION_LIST:"conversation-list",GROUP_LIST:"group-list",FRIEND_LIST:"friend-list",BLACK_LIST:"black-list"},_o={name:"SideBar",components:{MyProfile:or,ConversationList:Or,GroupList:Yr,FriendList:oo,BlackList:yo,ElPopover:Y.a,ElBadge:Yn.a},data:function(){return{active:wo.CONVERSATION_LIST,activeName:wo}},computed:Co({},Object(L["b"])(["totalUnreadCount"]),{showConversationList:function(){return this.active===wo.CONVERSATION_LIST},showGroupList:function(){return this.active===wo.GROUP_LIST},showFriendList:function(){return this.active===wo.FRIEND_LIST},showBlackList:function(){return this.active===wo.BLACK_LIST},showAddButton:function(){return[wo.CONVERSATION_LIST,wo.GROUP_LIST].includes(this.active)}}),methods:{checkoutActive:function(e){this.active=e},handleClick:function(e){switch(e.target.id){case wo.CONVERSATION_LIST:this.checkoutActive(wo.CONVERSATION_LIST);break;case wo.GROUP_LIST:this.checkoutActive(wo.GROUP_LIST);break;case wo.FRIEND_LIST:this.checkoutActive(wo.FRIEND_LIST);break;case wo.BLACK_LIST:this.checkoutActive(wo.BLACK_LIST);break}},handleRefresh:function(){switch(this.active){case wo.CONVERSATION_LIST:this.tim.getConversationList();break;case wo.GROUP_LIST:this.getGroupList();break;case wo.FRIEND_LIST:this.getFriendList();break;case wo.BLACK_LIST:this.$store.dispatch("getBlacklist");break}},getGroupList:function(){var e=this;this.tim.getGroupList().then(function(t){var n=t.data;e.$store.dispatch("updateGroupList",n)})},getFriendList:function(){var e=this;this.tim.getFriendList().then(function(t){var n=t.data;e.$store.commit("upadteFriendList",n)})}}},jo=_o,Po=(n("cede"),Object(I["a"])(jo,Bn,Fn,!1,null,"fea7a310",null)),Io=Po.exports,Do=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"login-wrapper"},[n("img",{staticStyle:{"border-radius":"5px","margin-bottom":"12px"},attrs:{src:e.logo,width:"50",height:"50"}}),n("el-select",{model:{value:e.userID,callback:function(t){e.userID=t},expression:"userID"}},e._l(30,function(e){return n("el-option",{key:e,attrs:{label:"user"+(e-1),value:"user"+(e-1)}})}),1),n("br"),n("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:e.login}},[e._v("登录")])],1)},xo=[],Eo=n("a1d8"),Mo=n.n(Eo),ko={name:"Login",components:{ElSelect:$t.a,ElOption:Gt.a},data:function(){return{userID:"user0",logo:Mo.a}},methods:{login:function(){this.$store.dispatch("login",this.userID)}}},To=ko,So=(n("6084"),Object(I["a"])(To,Do,xo,!1,null,null,null)),Lo=So.exports;function Go(e){var t=e.payload.groupProfile.groupName||e.payload.groupProfile.groupID;switch(e.payload.operationType){case 1:return"".concat(e.payload.operatorID," 申请加入群组：").concat(t);case 2:return"成功加入群组：".concat(t);case 3:return"申请加入群组：".concat(t,"被拒绝");case 4:return"被管理员".concat(e.payload.operatorID,"踢出群组：").concat(t);case 5:return"群：".concat(t," 已被").concat(e.payload.operatorID,"解散");case 6:return"".concat(e.payload.operatorID,"创建群：").concat(t);case 7:return"".concat(e.payload.operatorID,"邀请你加群：").concat(t);case 8:return"你退出群组：".concat(t);case 9:return"你被".concat(e.payload.operatorID,"设置为群：").concat(t,"的管理员");case 10:return"你被".concat(e.payload.operatorID,"撤销群：").concat(t,"的管理员身份");case 255:return"自定义群系统通知"}}function Ro(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function $o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ro(n,!0).forEach(function(t){Object(S["a"])(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ro(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var No={title:"TIMSDK DEMO",components:{Login:Lo,SideBar:Io,CurrentConversation:An},computed:$o({},Object(L["c"])({currentUserProfile:function(e){return e.user.currentUserProfile},currentConversation:function(e){return e.conversation.currentConversation},isLogin:function(e){return e.user.isLogin},isSDKReady:function(e){return e.user.isSDKReady}}),{showLoading:function(){return!this.isSDKReady}}),mounted:function(){this.initListener()},methods:{initListener:function(){var e=this;this.tim.on(this.TIM.EVENT.SDK_READY,this.onReadyStateUpdate,this),this.tim.on(this.TIM.EVENT.SDK_NOT_READY,this.onReadyStateUpdate,this),this.tim.on(this.TIM.EVENT.KICKED_OUT,function(t){var n=t.data.type,r=n===e.TIM.TYPES.KICKED_OUT_MULT_ACCOUNT?"您的账号已在其他页面登录":"您的账号已在其他设备登录";e.$message.error(r),e.$store.commit("toggleIsLogin",!1),e.$store.commit("reset")}),this.tim.on(this.TIM.EVENT.ERROR,this.onError),this.tim.on(this.TIM.EVENT.MESSAGE_RECEIVED,this.onReceiveMessage),this.tim.on(this.TIM.EVENT.CONVERSATION_LIST_UPDATED,function(t){e.$store.commit("updateConversationList",t.data)}),this.tim.on(this.TIM.EVENT.GROUP_LIST_UPDATED,function(t){e.$store.commit("updateGroupList",t.data)}),this.tim.on(this.TIM.EVENT.GROUP_SYSTEM_NOTICE_RECEIVED,function(t){var n=4===t.data.type,r="GROUP".concat(t.data.message.payload.groupProfile.groupID)===e.currentConversation.conversationID;n&&r&&e.$store.commit("resetCurrentConversation"),T()({title:"新系统通知",message:Go(t.data.message),duration:3e3,onClick:function(){var t="@TIM#SYSTEM";e.$store.dispatch("checkoutConversation",t)}})})},onReceiveMessage:function(e){var t=e.data;this.handleAt(t),this.$store.commit("pushCurrentMessageList",t)},onError:function(e){var t=e.data;this.$message.error(t.message)},onReadyStateUpdate:function(e){var t=this,n=e.name,r=n===this.TIM.EVENT.SDK_READY;this.$store.commit("toggleIsSDKReady",r),r&&(this.tim.getMyProfile().then(function(e){var n=e.data;t.$store.commit("updateCurrentUserProfile",n)}),this.$store.dispatch("getBlacklist"))},handleAt:function(e){for(var t=this,n=e.filter(function(e){return e.type===t.TIM.TYPES.MSG_TEXT&&e.payload.text.includes("@")}),r=0;r<n.length;r++){var o=n[r],i=o.payload.text.match(/@\w+/g);i&&(i.includes("@".concat(this.currentUserProfile.userID))&&(document.hidden&&this.notifyMe(o),T()({title:"有人在群".concat(o.conversationID.slice(5),"提到了你"),message:o.payload.text,duration:3e3}),this.$bus.$emit("new-messsage-at-me",{data:{conversationID:o.conversationID}})))}},notifyMe:function(e){var t=this;"Notification"in window&&("granted"===window.Notification.permission?this.handleNotify(e):"denied"!==window.Notification.permission&&window.Notification.requestPermission().then(function(n){"granted"===n&&t.handleNotify(e)}))},handleNotify:function(e){var t=this,n=new window.Notification("有人提到了你",{body:e.payload.text});n.onclick=function(){window.focus(),t.$store.dispatch("checkoutConversation",e.conversationID),n.close()}}}},Uo=No,Ao=(n("e00d"),Object(I["a"])(Uo,E,M,!1,null,null,null)),Bo=Ao.exports,Fo=n("75fc"),Vo=n("e23e"),Yo=n.n(Vo),qo=n("3438"),zo=n.n(qo),Ko=Yo.a.create({SDKAppID:window.genTestUserSig("").SDKAppID});Ko.registerPlugin({"cos-js-sdk":zo.a});var Jo=Ko,Ho={state:{currentConversation:{},currentMessageList:[],nextReqMessageID:"",isCompleted:!1,conversationList:[]},getters:{toAccount:function(e){if(!e.currentConversation||!e.currentConversation.conversationID)return"";switch(e.currentConversation.type){case"C2C":return e.currentConversation.conversationID.replace("C2C","");case"GROUP":return e.currentConversation.conversationID.replace("GROUP","");default:return e.currentConversation.conversationID}},currentConversationType:function(e){return e.currentConversation&&e.currentConversation.type?e.currentConversation.type:""},totalUnreadCount:function(e){return e.conversationList.reduce(function(t,n){return n.conversationID===e.currentConversation.conversationID?t:"GROUP"===n.type&&"AcceptNotNotify"===n.groupProfile.selfInfo.messageRemindType?t:t+n.unreadCount},0)},imgUrlList:function(e){return e.currentMessageList.filter(function(e){return e.type===Yo.a.TYPES.MSG_IMAGE}).map(function(e){return e.payload.imageInfoArray[0].url})}},mutations:{updateCurrentConversation:function(e,t){e.currentConversation=t,e.currentMessageList=[],e.nextReqMessageID="",e.isCompleted=!1},updateConversationList:function(e,t){e.conversationList=t},resetCurrentConversation:function(e){e.currentConversation={}},pushCurrentMessageList:function(e,t){if(e.currentConversation.conversationID)if(Array.isArray(t)){var n=t.filter(function(t){return t.conversationID===e.currentConversation.conversationID});e.currentMessageList=[].concat(Object(Fo["a"])(e.currentMessageList),Object(Fo["a"])(n))}else t.conversationID===e.currentConversation.conversationID&&(e.currentMessageList=[].concat(Object(Fo["a"])(e.currentMessageList),[t]))},reset:function(e){Object.assign(e,{currentConversation:{},currentMessageList:[],nextReqMessageID:"",isCompleted:!1,conversationList:[]})}},actions:{getMessageList:function(e,t){if(e.state.isCompleted)window.$message("已经没有更多的历史消息了哦");else{var n=e.state,r=n.nextReqMessageID,o=n.currentMessageList;Jo.getMessageList({conversationID:t,nextReqMessageID:r,count:15}).then(function(t){e.state.nextReqMessageID=t.data.nextReqMessageID,e.state.isCompleted=t.data.isCompleted,e.state.currentMessageList=[].concat(Object(Fo["a"])(t.data.messageList),Object(Fo["a"])(o))})}},checkoutConversation:function(e,t){if(e.commit("resetCurrentMemberList"),e.state.currentConversation.conversationID){var n=e.state.currentConversation.conversationID;Jo.setMessageRead({conversationID:n})}return Jo.setMessageRead({conversationID:t}),Jo.getConversationProfile(t).then(function(n){var r=n.data;return e.commit("updateCurrentConversation",r.conversation),e.dispatch("getMessageList",t),r.conversation.type===Yo.a.TYPES.CONV_GROUP?e.dispatch("getGroupMemberList",r.conversation.groupProfile.groupID):Promise.resolve()})}}},Wo=Ho,Zo={state:{groupList:[],currentMemberList:[],createGroupModelVisible:!1},getters:{hasGroupList:function(e){return e.groupList.length>0}},mutations:{updateGroupList:function(e,t){e.groupList=t},updateCreateGroupModelVisible:function(e,t){e.createGroupModelVisible=t},updateCurrentMemberList:function(e,t){e.currentMemberList=[].concat(Object(Fo["a"])(e.currentMemberList),Object(Fo["a"])(t))},resetCurrentMemberList:function(e){e.currentMemberList=[]},reset:function(e){Object.assign(e,{groupList:[],currentMemberList:[],createGroupModelVisible:!1})}},actions:{updateGroupList:function(e,t){e.commit("updateGroupList",t)},getGroupMemberList:function(e,t){return Jo.getGroupMemberList({groupID:t,offset:e.state.currentMemberList.length,count:30}).then(function(t){return e.commit("updateCurrentMemberList",t.data.memberList),t})}}},Xo=Zo,Qo={state:{currentUserProfile:{},isLogin:!1,isSDKReady:!1},mutations:{updateCurrentUserProfile:function(e,t){e.currentUserProfile=t},toggleIsLogin:function(e,t){e.isLogin="undefined"===typeof t?!e.isLogin:t},toggleIsSDKReady:function(e,t){e.isSDKReady="undefined"===typeof t?!e.isSDKReady:t},reset:function(e){Object.assign(e,{currentUserProfile:{},isLogin:!1,isSDKReady:!1})}},actions:{login:function(e,t){Jo.login({userID:t,userSig:window.genTestUserSig(t).userSig}).then(function(){e.commit("toggleIsLogin",!0),e.commit("startComputeCurrent")}).catch(function(e){2e3===e.code?window.$message.error(e.message+", 请检查是否正确填写了 SDKAPPID"):window.$message.error(e.message)})},logout:function(e){e.rootState.conversation.currentConversation.conversationID&&Jo.setMessageRead({conversationID:e.rootState.conversation.currentConversation.conversationID}),Jo.logout().then(function(){e.commit("toggleIsLogin"),e.commit("stopComputeCurrent"),e.commit("reset")})}}},ei=Qo,ti={state:{friendList:[],createGroupModelVisible:!1},mutations:{upadteFriendList:function(e,t){e.friendList=t},reset:function(e){Object.assign(e,{friendList:[],createGroupModelVisible:!1})}}},ni=ti,ri={state:{blacklist:[]},mutations:{updateBlacklist:function(e,t){e.blacklist=t},removeFromBlacklist:function(e,t){e.blacklist=e.blacklist.filter(function(e){return e.userID!==t})},reset:function(e){Object.assign(e,{blacklist:[]})}},actions:{getBlacklist:function(e){Jo.getBlacklist().then(function(e){var t=e.data;return Jo.getUserProfile({userIDList:t})}).then(function(t){var n=t.data;e.commit("updateBlacklist",n)})}}},oi=ri;y["default"].use(L["a"]);var ii=new L["a"].Store({state:{current:Date.now(),intervalID:0},mutations:{startComputeCurrent:function(e){e.intervalID=setInterval(function(){e.current=Date.now()},1e3)},stopComputeCurrent:function(e){clearInterval(e.intervalID),e.intervalID=0}},modules:{conversation:Wo,group:Xo,friend:ni,blacklist:oi,user:ei}});n("ed2c");window.tim=Jo,window.TIM=Yo.a,window.store=ii,window.$message=b.a,y["default"].prototype.$bus=new y["default"],y["default"].prototype.tim=Jo,y["default"].prototype.TIM=Yo.a,y["default"].prototype.$store=ii,y["default"].prototype.$message=b.a,y["default"].prototype.$confirm=g.a.confirm,y["default"].use(d.a),y["default"].use(m.a),y["default"].use(u.a),y["default"].use(c.a),y["default"].use(s.a),y["default"].use(o.a),y["default"].component("avatar",x),new y["default"]({render:function(e){return e(Bo)}}).$mount("#app")},"59c8":function(e,t,n){"use strict";var r=n("c60b"),o=n.n(r);o.a},"59f0":function(e,t,n){"use strict";var r=n("5ed0"),o=n.n(r);o.a},"5e55":function(e,t,n){},"5ed0":function(e,t,n){},6084:function(e,t,n){"use strict";var r=n("8cfb"),o=n.n(r);o.a},"61d3":function(e,t,n){"use strict";var r=n("ffde"),o=n.n(r);o.a},"6c81":function(e,t,n){"use strict";var r=n("04d2"),o=n.n(r);o.a},"6d4b":function(e,t,n){"use strict";var r=n("4984"),o=n.n(r);o.a},"6ddb":function(e,t,n){},"6ec7":function(e,t,n){"use strict";var r=n("2650"),o=n.n(r);o.a},"7a1b":function(e,t,n){},"7bb5":function(e,t,n){},"8c43":function(e,t,n){"use strict";var r=n("07ca"),o=n.n(r);o.a},"8cfb":function(e,t,n){},"8fbb":function(e,t,n){},"911c":function(e,t,n){},"95c5":function(e,t,n){"use strict";var r=n("8fbb"),o=n.n(r);o.a},"96e8":function(e,t,n){"use strict";var r=n("5e55"),o=n.n(r);o.a},"99f2":function(e,t,n){"use strict";var r=n("a02c"),o=n.n(r);o.a},a028:function(e,t,n){},a02c:function(e,t,n){},a1d8:function(e,t,n){e.exports=n.p+"img/logo.0d4ebf2b.png"},a4fd:function(e,t,n){"use strict";var r=n("7bb5"),o=n.n(r);o.a},ac04:function(e,t,n){},b813:function(e,t,n){},be7f:function(e,t,n){},c57c:function(e,t,n){},c60b:function(e,t,n){},c6a9:function(e,t,n){"use strict";var r=n("c57c"),o=n.n(r);o.a},cede:function(e,t,n){"use strict";var r=n("b813"),o=n.n(r);o.a},d546:function(e,t,n){},d606:function(e,t,n){"use strict";var r=n("7a1b"),o=n.n(r);o.a},d67e:function(e,t,n){"use strict";var r=n("f3cc"),o=n.n(r);o.a},d920:function(e,t,n){},df23:function(e,t,n){"use strict";var r=n("6ddb"),o=n.n(r);o.a},e00d:function(e,t,n){"use strict";var r=n("3f6f"),o=n.n(r);o.a},e336:function(e,t,n){"use strict";var r=n("5371"),o=n.n(r);o.a},e8a0:function(e,t,n){"use strict";var r=n("d546"),o=n.n(r);o.a},ed2c:function(e,t,n){},f095:function(e,t,n){"use strict";var r=n("911c"),o=n.n(r);o.a},f2c2:function(e,t,n){},f39d:function(e,t,n){"use strict";var r=n("3b88"),o=n.n(r);o.a},f3cc:function(e,t,n){},f822:function(e,t,n){"use strict";var r=n("be7f"),o=n.n(r);o.a},ffde:function(e,t,n){}});