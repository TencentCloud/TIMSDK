require("../../common/manifest.js")
require("../../debug/GenerateTestUserSig.js")
require("../../common/vendor.js")
global.webpackJsonpMpvue([10],{"5vTQ":function(t,s,e){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var a=function(t){return t&&t.__esModule?t:{default:t}}(e("Dd8w")),n=e("NYxO"),i=e("0xDb");s.default={data:function(){return{modalVisible:!1,conversation:{}}},computed:(0,a.default)({},(0,n.mapState)({allConversation:function(t){return t.conversation.allConversation},isSdkReady:function(t){return t.global.isSdkReady}}),(0,n.mapGetters)(["totalUnreadCount","myInfo"])),onPullDownRefresh:function(){(0,i.throttle)(wx.$app.getConversationList(),1e3),wx.stopPullDownRefresh()},methods:{longTimePress:function(t){this.conversation=t,this.handleModalShow()},handleModalShow:function(){this.modalVisible=!this.modalVisible},handleConfirm:function(){this.handleModalShow(),this.deleteConversation(this.conversation)},setMessageRead:function(t){0!==t.unreadCount&&wx.$app.setMessageRead({conversationID:t.conversationID})},checkoutConversation:function(t,s){this.$store.dispatch("checkoutConversation",t.conversationID)},checkoutNotification:function(t){var s=this;this.$store.commit("resetCurrentConversation"),this.$store.commit("resetGroup"),this.setMessageRead(t),wx.$app.getConversationProfile(t.conversationID).then(function(t){s.$store.commit("updateCurrentConversation",t.data.conversation),s.$store.dispatch("getMessageList")});wx.navigateTo({url:"../system/main"})},deleteConversation:function(t){wx.$app.deleteConversation(t.conversationID).then(function(t){console.log("delete success",t)})},empty:function(){wx.navigateTo({url:"../search/main"})}},onLoad:function(){this.isSdkReady||wx.showLoading({title:"正在同步数据",mask:!0})},watch:{isSdkReady:function(t){t&&wx.hideLoading()}}}},MhDc:function(t,s,e){"use strict";var a=i(e("5nAL")),n=i(e("Qt9A"));function i(t){return t&&t.__esModule?t:{default:t}}a.default.config.errorHandler=function(t){console&&console.error&&console.error(t)},new a.default(n.default).$mount()},Qt9A:function(t,s,e){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var a=e("5vTQ"),n=e.n(a),i=e("nlVh");var o=function(t){e("wRfu")},r=e("ybqe")(n.a,i.a,o,null,null);s.default=r.exports},nlVh:function(t,s,e){"use strict";var a={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"chat-container"},[0===t.allConversation.length?e("div",{staticClass:"empty"},[e("button",{staticClass:"empty-button",attrs:{type:"button",eventid:"0"},on:{click:t.empty}},[t._v("\n      发起一段对话吧\n    ")])],1):t._e(),t._v(" "),e("i-modal",{attrs:{title:"确认删除会话？",visible:t.modalVisible,eventid:"1",mpcomid:"0"},on:{ok:function(s){t.handleConfirm()},cancel:t.handleModalShow}}),t._v(" "),t._l(t.allConversation,function(s,a){return["C2C"===s.type?e("div",{key:s.conversationID,staticClass:"chat",attrs:{eventid:"4_"+a},on:{longpress:function(e){t.longTimePress(s)},click:function(e){t.checkoutConversation(s,s.userProfile.nick||s.userProfile.userID)}}},[e("div",{staticClass:"avatar-container"},[e("i-avatar",{attrs:{src:s.userProfile.avatar||"/static/images/avatar.png","i-class":"avatar",mpcomid:"1_"+a}})],1),t._v(" "),e("div",{staticClass:"right"},[e("div",{staticClass:"information"},[e("div",{staticClass:"username"},[t._v(t._s(s.userProfile.nick||s.userProfile.userID))]),t._v(" "),s.lastMessage.isRevoked?e("div",{staticClass:"content"},[t.myInfo.userID===s.lastMessage.fromAccount?[t._v("你撤回了一条消息")]:[t._v(t._s(s.lastMessage.fromAccount)+"撤回了一条消息")]],2):e("div",{staticClass:"content"},[t._v(t._s(s.lastMessage.messageForShow))])]),t._v(" "),e("div",{staticClass:"time"},[e("div",{staticClass:"last"},[t._v(t._s(s.lastMessage._lastTime))]),t._v(" "),s.unreadCount>0?e("div",{staticClass:"remain"},[s.unreadCount>99?e("span",{staticClass:"info"},[t._v("99+")]):e("span",{staticClass:"info"},[t._v(t._s(s.unreadCount))])]):t._e()])])]):"GROUP"===s.type?e("div",{key:s.conversationID,staticClass:"chat",attrs:{eventid:"2_"+a},on:{click:function(e){t.checkoutConversation(s,s.groupProfile.name||s.groupProfile.ID)},longpress:function(e){t.longTimePress(s)}}},[e("div",{staticClass:"avatar-container"},[e("i-avatar",{attrs:{src:s.groupProfile.avatar,"i-class":"avatar",mpcomid:"4_"+a}})],1),t._v(" "),e("div",{staticClass:"right"},[e("div",{staticClass:"information"},[e("div",{staticClass:"username"},[t._v(t._s(s.groupProfile.name||s.groupProfile.groupID))]),t._v(" "),s.lastMessage.isRevoked?e("div",{staticClass:"content"},[t.myInfo.userID===s.lastMessage.fromAccount?[t._v("你撤回了一条消息")]:[t._v(t._s(s.lastMessage.fromAccount)+"撤回了一条消息")]],2):e("div",{staticClass:"content"},["@TIM#SYSTEM"===s.lastMessage.fromAccount?[t._v(t._s(s.lastMessage.messageForShow))]:[t._v(t._s(s.lastMessage.fromAccount)+"："+t._s(s.lastMessage.messageForShow))]],2)]),t._v(" "),e("div",{staticClass:"time"},[e("div",{staticClass:"last"},[t._v(t._s(s.lastMessage._lastTime))]),t._v(" "),s.unreadCount>0?e("div",{staticClass:"remain"},[s.unreadCount>99?e("span",{staticClass:"info"},[t._v("99+")]):e("span",{staticClass:"info"},[t._v(t._s(s.unreadCount))])]):t._e()])])]):"@TIM#SYSTEM"===s.type?e("div",{key:s.conversationID,staticClass:"chat",attrs:{eventid:"3_"+a},on:{click:function(e){t.checkoutNotification(s)},longpress:function(e){t.longTimePress(s)}}},[t._m(0,!0),t._v(" "),e("div",{staticClass:"right"},[t._m(1,!0),t._v(" "),e("div",{staticClass:"time"},[e("div",{staticClass:"last"}),t._v(" "),s.unreadCount>0?e("div",{staticClass:"remain"},[s.unreadCount>99?e("span",{staticClass:"info"},[t._v("99+")]):e("span",{staticClass:"info"},[t._v(t._s(s.unreadCount))])]):t._e()])])]):t._e()]})],2)},staticRenderFns:[function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"avatar-container"},[s("image",{staticClass:"avatar",attrs:{src:"/static/images/system.png"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"information"},[s("div",{staticClass:"username"},[this._v("系统通知")]),this._v(" "),s("div",{staticClass:"content"},[this._v("点击查看")])])}]};s.a=a},wRfu:function(t,s){}},["MhDc"]);