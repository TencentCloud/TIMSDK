require("../../common/manifest.js")
require("../../debug/GenerateTestUserSig.js")
require("../../common/vendor.js")
global.webpackJsonpMpvue([8],{"5vTQ":function(t,s,e){"use strict";var a=e("Dd8w"),o=e.n(a),i=e("NYxO"),n=e("0xDb");s.a={data:function(){return{modalVisible:!1,conversation:{}}},computed:o()({},Object(i.b)({allConversation:function(t){return t.conversation.allConversation}})),onPullDownRefresh:function(){Object(n.b)(wx.$app.getConversationList(),1e3),wx.stopPullDownRefresh()},methods:{longTimePress:function(t){this.conversation=t,this.handleModalShow()},handleModalShow:function(){this.modalVisible=!this.modalVisible},handleConfirm:function(){this.handleModalShow(),this.deleteConversation(this.conversation)},setMessageRead:function(t){0!==t.unreadCount&&wx.$app.setMessageRead({conversationID:t.conversationID})},checkoutConversation:function(t,s){var e=this;t.lastMessage.at&&this.$store.commit("offAtRemind",t),this.$store.commit("resetCurrentConversation"),this.$store.commit("resetGroup"),this.setMessageRead(t),wx.$app.getConversationProfile(t.conversationID).then(function(s){if(e.$store.commit("updateCurrentConversation",s.data.conversation),e.$store.dispatch("getMessageList"),t.type===e.TIM.TYPES.CONV_GROUP){var a=t.conversationID.substring(5);wx.$app.getGroupProfile({groupID:a}).then(function(t){e.$store.commit("updateCurrentGroupProfile",t.data.group)})}});var a="../chat/main?toAccount="+s;wx.navigateTo({url:a})},checkoutNotification:function(t){var s=this;this.$store.commit("resetCurrentConversation"),this.$store.commit("resetGroup"),this.setMessageRead(t),wx.$app.getConversationProfile(t.conversationID).then(function(t){s.$store.commit("updateCurrentConversation",t.data.conversation),s.$store.dispatch("getMessageList")});wx.navigateTo({url:"../system/main"})},deleteConversation:function(t){wx.$app.deleteConversation(t.conversationID).then(function(t){console.log("delete success",t)})}},onLoad:function(){var t=this;wx.$app.getMyProfile().then(function(s){t.$store.commit("updateMyInfo",s.data)}),wx.$app.getBlacklist().then(function(s){t.$store.commit("setBlacklist",s.data)})},mounted:function(){}}},GJBe:function(t,s,e){"use strict";var a={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"chatting"},t._l(t.allConversation,function(s,a){return e("div",{key:s.conversationID,staticClass:"chat"},[e("i-modal",{attrs:{title:"确认删除会话？",visible:t.modalVisible,eventid:"0_"+a,mpcomid:"0_"+a},on:{ok:function(s){t.handleConfirm()},cancel:t.handleModalShow}}),t._v(" "),e("div",{attrs:{eventid:"4_"+a},on:{longpress:function(e){t.longTimePress(s)}}},["C2C"===s.type?e("i-row",{attrs:{eventid:"3_"+a,mpcomid:"12_"+a},on:{click:function(e){t.checkoutConversation(s,s.userProfile.nick||s.userProfile.userID)}},slot:"content"},[e("i-col",{attrs:{span:"4",mpcomid:"2_"+a}},[e("div",{staticClass:"avatar"},[e("i-avatar",{attrs:{src:s.userProfile.avatar||"/static/images/header.png",size:"large",shape:"square",mpcomid:"1_"+a}})],1)]),t._v(" "),e("i-col",{attrs:{span:"20",mpcomid:"3_"+a}},[e("div",{staticClass:"right"},[e("div",{staticClass:"information"},[e("div",{staticClass:"username"},[t._v(t._s(s.userProfile.nick||s.userProfile.userID))]),t._v(" "),e("div",{staticClass:"last"},[t._v(t._s(s.lastMessage._lastTime))])]),t._v(" "),e("div",{staticClass:"information"},[e("div",{staticClass:"content"},[t._v(t._s(s.lastMessage.messageForShow))]),t._v(" "),s.unreadCount>0?e("div",{staticClass:"remain"},[t._v(t._s(s.unreadCount))]):t._e()])])])],1):"GROUP"===s.type?e("i-row",{attrs:{eventid:"1_"+a,mpcomid:"7_"+a},on:{click:function(e){t.checkoutConversation(s,s.groupProfile.name||s.groupProfile.ID)}},slot:"content"},[e("i-col",{attrs:{span:"4",mpcomid:"5_"+a}},[e("div",{staticClass:"avatar"},[e("i-avatar",{attrs:{src:s.groupProfile.avatar||"/static/images/groups.png",size:"large",shape:"square",mpcomid:"4_"+a}})],1)]),t._v(" "),e("i-col",{attrs:{span:"20",mpcomid:"6_"+a}},[e("div",{staticClass:"right"},[e("div",{staticClass:"information"},[e("div",{staticClass:"username"},[t._v(t._s(s.groupProfile.name||s.groupProfile.groupID))]),t._v(" "),e("div",{staticClass:"last"},[t._v(t._s(s.lastMessage._lastTime))])]),t._v(" "),e("div",{staticClass:"information"},["@TIM#SYSTEM"===s.lastMessage.fromAccount?e("div",{staticClass:"content"},[t._v(t._s(s.lastMessage.messageForShow))]):"TIMCustomElem"===s.lastMessage.type?e("div",{staticClass:"content"},[t._v("[自定义消息]")]):s.lastMessage.at&&s.unreadCount>0?e("div",{staticClass:"content-red"},[t._v("[有人@你了]")]):e("div",{staticClass:"content"},[t._v(t._s(s.lastMessage.fromAccount)+"："+t._s(s.lastMessage.messageForShow))]),t._v(" "),s.unreadCount>0?e("div",{staticClass:"remain"},[t._v(t._s(s.unreadCount))]):t._e()])])])],1):"@TIM#SYSTEM"===s.type?e("i-row",{attrs:{eventid:"2_"+a,mpcomid:"11_"+a},on:{click:function(e){t.checkoutNotification(s)}},slot:"content"},[e("i-col",{attrs:{span:"4",mpcomid:"9_"+a}},[e("div",{staticClass:"avatar"},[e("i-avatar",{attrs:{src:"../../../static/images/system.png",size:"large",shape:"square",mpcomid:"8_"+a}})],1)]),t._v(" "),e("i-col",{attrs:{span:"20",mpcomid:"10_"+a}},[e("div",{staticClass:"right"},[e("div",{staticClass:"information"},[e("div",{staticClass:"username"},[t._v("系统通知")]),t._v(" "),s.unreadCount>0?e("div",{staticClass:"remain"},[t._v(t._s(s.unreadCount))]):t._e()]),t._v(" "),e("div",{staticClass:"information"},[e("div",{staticClass:"content"},[t._v("点击查看")])])])])],1):t._e()],1)],1)}))},staticRenderFns:[]};s.a=a},MhDc:function(t,s,e){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var a=e("5nAL"),o=e.n(a),i=e("Qt9A");o.a.config.errorHandler=function(t){console&&console.error&&console.error(t)},new o.a(i.a).$mount()},Qt9A:function(t,s,e){"use strict";var a=e("5vTQ"),o=e("GJBe");var i=function(t){e("oVXD")},n=e("ybqe")(a.a,o.a,i,"data-v-0c62411e",null);s.a=n.exports},oVXD:function(t,s){}},["MhDc"]);