require("./common/manifest.js")
require("./debug/GenerateTestUserSig.js")
require("./common/vendor.js")
global.webpackJsonpMpvue([1],{"17x+":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={state:{isSdkReady:!1,isCalling:!1,rtcConfig:{}},getters:{isSdkReady:function(e){return e.isSdkReady},isCalling:function(e){return e.isCalling},rtcConfig:function(e){return e.rtcConfig}},mutations:{showToast:function(e,t){wx.showToast({title:t.title,icon:t.icon||"none",duration:t.duration||800})},setSdkReady:function(e,t){e.isSdkReady=t},setCalling:function(e,t){e.isCalling=t},setRtcConfig:function(e,t){e.rtcConfig=t}},actions:{resetStore:function(e){e.commit("resetGroup"),e.commit("resetUser"),e.commit("resetCurrentConversation"),e.commit("resetAllConversation")}}};t.default=n},IcnI:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(a("5nAL")),r=c(a("NYxO")),o=c(a("tn05")),s=c(a("xTcS")),i=c(a("bREw")),u=c(a("17x+"));function c(e){return e&&e.__esModule?e:{default:e}}n.default.use(r.default),t.default=new r.default.Store({modules:{conversation:o.default,group:s.default,user:i.default,global:u.default}})},M93x:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("Mw+1"),r=a.n(n);var o=function(e){a("xIC6")},s=a("ybqe")(r.a,null,o,null,null);t.default=s.exports},"Mw+1":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={created:function(){}}},NHnr:function(e,t,a){"use strict";var n=f(a("5nAL")),r=f(a("M93x")),o=f(a("PDEy")),s=f(a("IcnI")),i=f(a("oqQY"));a("uM1m");var u=a("0xDb"),c=f(a("h1dT")),l=a("dutN"),d=f(a("Bbwh"));function f(e){return e&&e.__esModule?e:{default:e}}var p=o.default.create({SDKAppID:l.SDKAPPID});p.setLogLevel(0),wx.$app=p,wx.$app.registerPlugin({"cos-wx-sdk":c.default}),wx.store=s.default,wx.TIM=o.default,wx.dayjs=i.default,i.default.locale("zh-cn");var m=new n.default;function v(e){var t=e.name===o.default.EVENT.SDK_READY;t&&(wx.$app.getMyProfile().then(function(e){s.default.commit("updateMyInfo",e.data)}),wx.$app.getBlacklist().then(function(e){s.default.commit("setBlacklist",e.data)})),s.default.commit("setSdkReady",t)}n.default.prototype.TIM=o.default,n.default.prototype.$type=d.default,n.default.prototype.$store=s.default,n.default.prototype.$bus=m,p.on(o.default.EVENT.SDK_READY,v,void 0),p.on(o.default.EVENT.SDK_NOT_READY,v,void 0),p.on(o.default.EVENT.KICKED_OUT,function(e){s.default.dispatch("resetStore"),wx.showToast({title:"你已被踢下线",icon:"none",duration:1500}),setTimeout(function(){wx.reLaunch({url:"../login/main"})},500)},void 0),p.on(o.default.EVENT.ERROR,function(e){e.data.message&&e.data.code&&2800!==e.data.code&&2999!==e.data.code&&s.default.commit("showToast",{title:e.data.message,duration:2e3})},void 0),p.on(o.default.EVENT.MESSAGE_RECEIVED,function(e){for(var t=0;t<e.data.length;t++){var a=e.data[t];if(a.type===d.default.MSG_GRP_TIP&&a.payload.operationType&&m.$emit("groupNameUpdate",a.payload),a.type===d.default.MSG_CUSTOM&&(0,u.isJSON)(a.payload.data)){var n=JSON.parse(a.payload.data);if(3===n.version)switch(n.action){case 0:if(s.default.getters.isCalling)m.$emit("isCalling",a);else{var r="../call/main?args="+a.payload.data+"&&from="+a.from+"&&to="+a.to;wx.navigateTo({url:r})}break;case 1:wx.navigateBack({delta:1});break;case 2:m.$emit("onRefuse");break;case 3:wx.navigateBack({delta:1});break;case 4:m.$emit("onCall",n);break;case 5:m.$emit("onClose");break;case 6:m.$emit("onBusy")}}}s.default.dispatch("onMessageEvent",e)},void 0),p.on(o.default.EVENT.CONVERSATION_LIST_UPDATED,function(e){s.default.commit("updateAllConversation",e.data)},void 0),p.on(o.default.EVENT.GROUP_LIST_UPDATED,function(e){s.default.commit("updateGroupList",e.data)},void 0),p.on(o.default.EVENT.BLACKLIST_UPDATED,function(e){s.default.commit("updateBlacklist",e.data)},void 0),p.on(o.default.EVENT.NET_STATE_CHANGE,function(e){console.log(e.data.state),s.default.commit("showToast",function(e){switch(e){case o.default.TYPES.NET_STATE_CONNECTED:return{title:"已接入网络",duration:2e3};case o.default.TYPES.NET_STATE_CONNECTING:return{title:"当前网络不稳定",duration:2e3};case o.default.TYPES.NET_STATE_DISCONNECTED:return{title:"当前网络不可用",duration:2e3};default:return""}}(e.data.state))},void 0),p.on(o.default.EVENT.MESSAGE_READ_BY_PEER,function(e){console.log(e)});var g=wx.getSystemInfoSync();s.default.commit("setSystemInfo",g),new n.default({TIMApp:r.default}).$mount()},Srkd:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){return e&&e.__esModule?e:{default:e}}(a("BO1k"));t.decodeElement=function(e){switch(e.type){case"TIMTextElem":return function(e){var t=[],a=e.payload.text,n=-1,o=-1;for(;""!==a;)switch(n=a.indexOf("["),o=a.indexOf("]"),n){case 0:if(-1===o)t.push({name:"span",text:a}),a="";else{var s=a.slice(0,o+1);r.emojiMap[s]?(t.push({name:"img",src:r.emojiUrl+r.emojiMap[s]}),a=a.substring(o+1)):(t.push({name:"span",text:"["}),a=a.slice(1))}break;case-1:t.push({name:"span",text:a}),a="";break;default:t.push({name:"span",text:a.slice(0,n)}),a=a.substring(n)}return t}(e);case"TIMGroupSystemNoticeElem":return function(e){var t=e.payload,a=t.groupProfile.name||t.groupProfile.groupID,n=void 0;switch(t.operationType){case 1:n=t.operatorID+" 申请加入群组："+a;break;case 2:n="成功加入群组："+a;break;case 3:n="申请加入群组："+a+"被拒绝";break;case 4:n="被管理员"+t.operatorID+"踢出群组："+a;break;case 5:n="群："+a+" 已被"+t.operatorID+"解散";break;case 6:n=t.operatorID+"创建群："+a;break;case 7:n=t.operatorID+"邀请你加群："+a;break;case 8:n="你退出群组："+a;break;case 9:n="你被"+t.operatorID+"设置为群："+a+"的管理员";break;case 10:n="你被"+t.operatorID+"撤销群："+a+"的管理员身份";break;case 255:n="自定义群系统通知: "+t.userDefinedField}return[{name:"system",text:n}]}(e);case"TIMGroupTipElem":return function(e){var t=e.payload,a=e.nick||t.userIDList.join(","),r=void 0;switch(t.operationType){case s.MEMBER_JOIN:r="新成员加入："+a;break;case s.MEMBER_QUIT:r="群成员退群："+a;break;case s.MEMBER_KICKED_OUT:r="群成员被踢："+a;break;case s.MEMBER_SET_ADMIN:r=t.operatorID+"将 "+a+"设置为管理员";break;case s.MEMBER_CANCELED_ADMIN:r=t.operatorID+"将 "+a+"取消作为管理员";break;case s.GROUP_INFO_MODIFIED:r="群资料修改";break;case s.MEMBER_INFO_MODIFIED:var o=!0,i=!1,u=void 0;try{for(var c,l=(0,n.default)(t.memberList);!(o=(c=l.next()).done);o=!0){var d=c.value;r=d.muteTime>0?"群成员："+d.userID+"被禁言"+d.muteTime+"秒":"群成员："+d.userID+"被取消禁言"}}catch(e){i=!0,u=e}finally{try{!o&&l.return&&l.return()}finally{if(i)throw u}}}return[{name:"groupTip",text:r}]}(e);case"TIMCustomElem":return function(e){var t=e.payload.data;if((0,o.isJSON)(t)&&(t=JSON.parse(t)).hasOwnProperty("version")&&3===t.version){var a=void 0,n=(0,o.formatDuration)(t.duration);switch(t.action){case-2:a="异常挂断";break;case 0:a="请求通话";break;case 1:a="取消通话";break;case 2:a="拒绝通话";break;case 3:a="无应答";break;case 4:a="开始通话";break;case 5:a=0===t.duration?"结束通话":"结束通话，通话时长"+n;break;case 6:a="正在通话中"}return[{name:"videoCall",text:a}]}return[{name:"custom",text:t}]}(e);default:return[]}};var r=a("lRgn"),o=a("0xDb");var s={MEMBER_JOIN:1,MEMBER_QUIT:2,MEMBER_KICKED_OUT:3,MEMBER_SET_ADMIN:4,MEMBER_CANCELED_ADMIN:5,GROUP_INFO_MODIFIED:6,MEMBER_INFO_MODIFIED:7}},bREw:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={state:{myInfo:{},userProfile:{},blacklist:[]},getters:{myInfo:function(e){return e.myInfo},userProfile:function(e){return e.userProfile}},mutations:{updateMyInfo:function(e,t){e.myInfo=t},updateUserProfile:function(e,t){e.userProfile=t},setBlacklist:function(e,t){e.blacklist=t},updateBlacklist:function(e,t){e.blacklist.push(t)},resetUser:function(e){e.blacklist=[],e.userProfile={},e.myInfo={}}}}},tn05:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(a("//Fk")),r=u(a("Gu7T")),o=a("0xDb"),s=a("Srkd"),i=u(a("PDEy"));function u(e){return e&&e.__esModule?e:{default:e}}var c={state:{allConversation:[],currentConversationID:"",currentConversation:{},currentMessageList:[],nextReqMessageID:"",isCompleted:!1,isLoading:!1},getters:{allConversation:function(e){return e.allConversation},toAccount:function(e){return 0===e.currentConversationID.indexOf("C2C")?e.currentConversationID.substring(3):0===e.currentConversationID.indexOf("GROUP")?e.currentConversationID.substring(5):void 0},toName:function(e){return"C2C"===e.currentConversation.type?e.currentConversation.userProfile.userID:"GROUP"===e.currentConversation.type?e.currentConversation.groupProfile.name:void 0},currentConversationType:function(e){return 0===e.currentConversationID.indexOf("C2C")?"C2C":0===e.currentConversationID.indexOf("GROUP")?"GROUP":""},currentConversation:function(e){return e.currentConversation},currentMessageList:function(e){return e.currentMessageList},totalUnreadCount:function(e){var t=e.allConversation.reduce(function(e,t){return e+t.unreadCount},0);return 0===t?wx.removeTabBarBadge({index:0}):wx.setTabBarBadge({index:0,text:t>99?"99+":String(t)}),t}},mutations:{unshiftMessageList:function(e,t){for(var a=[].concat((0,r.default)(t)),n=0;n<a.length;n++){var i=a[n];a[n].virtualDom=(0,s.decodeElement)(i);var u=new Date(1e3*i.time);a[n].newtime=(0,o.formatTime)(u)}e.currentMessageList=[].concat((0,r.default)(a),(0,r.default)(e.currentMessageList))},receiveMessage:function(e,t){for(var a=[].concat((0,r.default)(t)),n=0;n<a.length;n++){var i=a[n];a[n].virtualDom=(0,s.decodeElement)(i);var u=new Date(1e3*i.time);a[n].newtime=(0,o.formatTime)(u)}e.currentMessageList=[].concat((0,r.default)(e.currentMessageList),(0,r.default)(a))},sendMessage:function(e,t){t.virtualDom=(0,s.decodeElement)(t);var a=new Date(1e3*t.time);t.newtime=(0,o.formatTime)(a),e.currentMessageList.push(t),setTimeout(function(){wx.pageScrollTo({scrollTop:99999})},800)},updateCurrentConversation:function(e,t){e.currentConversation=t,e.currentConversationID=t.conversationID},updateAllConversation:function(e,t){for(var a=0;a<t.length;a++)if(t[a].lastMessage&&"number"==typeof t[a].lastMessage.lastTime){var n=new Date(1e3*t[a].lastMessage.lastTime);t[a].lastMessage._lastTime=(0,o.formatTime)(n)}e.allConversation=t},resetCurrentConversation:function(e){e.currentConversationID="",e.currentConversation={},e.currentMessageList=[],e.nextReqMessageID="",e.isCompleted=!1,e.isLoading=!1},resetAllConversation:function(e){e.allConversation=[]},removeMessage:function(e,t){e.currentMessageList.splice(e.currentMessageList.findIndex(function(e){return e.ID===t.ID}),1)},changeMessageStatus:function(e,t){e.currentMessageList[t].status="fail"}},actions:{onMessageEvent:function(e,t){if("onMessageReceived"===t.name){var a=e.state.currentConversationID;if(!a)return;var n=[];t.data.forEach(function(e){e.conversationID===a&&n.push(e)}),e.commit("receiveMessage",n)}},getMessageList:function(e){var t=e.state,a=t.currentConversationID,n=t.nextReqMessageID;e.state.isCompleted?wx.showToast({title:"没有更多啦",icon:"none",duration:1500}):e.state.isLoading?wx.showToast({title:"你拉的太快了",icon:"none",duration:500}):(e.state.isLoading=!0,wx.$app.getMessageList({conversationID:a,nextReqMessageID:n,count:15}).then(function(t){e.state.nextReqMessageID=t.data.nextReqMessageID,e.commit("unshiftMessageList",t.data.messageList),t.data.isCompleted&&(e.state.isCompleted=!0),e.state.isLoading=!1}).catch(function(e){console.log(e)}))},checkoutConversation:function(e,t){return e.commit("resetCurrentConversation"),wx.$app.setMessageRead({conversationID:t}),wx.$app.getConversationProfile(t).then(function(t){var a=t.data.conversation;e.commit("updateCurrentConversation",a),e.dispatch("getMessageList");var r="";switch(a.type){case i.default.TYPES.CONV_C2C:r=a.userProfile.nick||a.userProfile.userID;break;case i.default.TYPES.CONV_GROUP:r=a.groupProfile.name||a.groupProfile.groupID;break;default:r="系统通知"}return wx.navigateTo({url:"../chat/main?toAccount="+r+"&type="+a.type}),n.default.resolve()})}}};t.default=c},xIC6:function(e,t){},xTcS:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){return e&&e.__esModule?e:{default:e}}(a("Gu7T"));var r={state:{groupList:[],currentGroupMemberList:[],count:15,isLoading:!1},getters:{hasGroupList:function(e){return e.groupList.length>0}},mutations:{updateGroupList:function(e,t){e.groupList=t},updateCurrentGroupMemberList:function(e,t){e.currentGroupMemberList=[].concat((0,n.default)(e.currentGroupMemberList),(0,n.default)(t))},resetGroup:function(e){e.groupList=[],e.currentGroupProfile={},e.currentGroupMemberList=[]},resetCurrentMemberList:function(e){e.currentGroupMemberList=[]}},actions:{getGroupMemberList:function(e){var t=e.rootState.conversation.currentConversation.groupProfile,a=t.memberCount,n=t.groupID,r=e.state,o=r.count,s=r.isLoading,i=e.state.currentGroupMemberList.length;i<a?s?wx.showToast({title:"你拉的太快了",icon:"none",duration:500}):(e.state.isLoading=!0,wx.$app.getGroupMemberList({groupID:n,offset:i,count:o}).then(function(t){e.commit("updateCurrentGroupMemberList",t.data.memberList),e.state.isLoading=!1}).catch(function(e){console.log(e)})):wx.showToast({title:"没有更多啦",icon:"none",duration:1500})}}};t.default=r}},["NHnr"]);